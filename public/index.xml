<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Tony Tsai</title>
    <link>http://blog.tonytsai.name/index.xml</link>
    <description>Recent content on Tony Tsai</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Thu, 05 Jan 2017 23:44:46 -0400</lastBuildDate>
    <atom:link href="http://blog.tonytsai.name/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Test MathJax</title>
      <link>http://blog.tonytsai.name/blog/2017-01-05-test-mathjax/</link>
      <pubDate>Thu, 05 Jan 2017 23:44:46 -0400</pubDate>
      
      <guid>http://blog.tonytsai.name/blog/2017-01-05-test-mathjax/</guid>
      <description>&lt;p&gt;The first test case is to create a matrix
$$
\begin{matrix}
  1 &amp;amp; x &amp;amp; x^2 &lt;br /&gt;
  1 &amp;amp; y &amp;amp; y^2 &lt;br /&gt;
  1 &amp;amp; z &amp;amp; z^2 &lt;br /&gt;
\end{matrix}
$$&lt;/p&gt;

&lt;p&gt;but all elemments of the matrix are displayed in one line. Fortunately, this can be solved by wraping the math expression inside a &lt;code&gt;&amp;lt;div&amp;gt; &amp;lt;/div&amp;gt;&lt;/code&gt; block, which is hinted by the hugo documents of &lt;a href=&#34;https://gohugo.io/tutorials/mathjax/&#34; target=&#34;_blank&#34;&gt;MathJax Support&lt;/a&gt;. besides, the blank line before &lt;code&gt;&amp;lt;div&amp;gt; &amp;lt;/div&amp;gt;&lt;/code&gt; block is necessary, otherwise the matrix would not be displayed correctly.&lt;/p&gt;

&lt;div&gt;
$$
\begin{matrix}
  1 &amp; x &amp; x^2 \\
  1 &amp; y &amp; y^2 \\
  1 &amp; z &amp; z^2 \\
\end{matrix}
$$
&lt;/div&gt;

&lt;p&gt;Actually, what I would like to do is to display multi-line equations.Taking the example from the stackoverflow question &lt;a href=&#34;http://stackoverflow.com/questions/18860693/mathjax-multi-line-equation-rendering-issue&#34; target=&#34;_blank&#34;&gt;Mathjax multi-line equation rendering issue&lt;/a&gt;, I input following MathJax expressions.&lt;/p&gt;

&lt;p&gt;$$
\begin{eqnarray}
y &amp;amp;=&amp;amp; x^4 + 4      \nonumber &lt;br /&gt;
  &amp;amp;=&amp;amp; (x^2+2)^2 -4x^2 \nonumber &lt;br /&gt;
  &amp;amp;\le&amp;amp;(x^2+2)^2    \nonumber
\end{eqnarray}
$$&lt;/p&gt;

&lt;p&gt;As you can see, the equations are displayed in one line. From the comments of the question, the solution is to use &lt;code&gt;\\\\\\&lt;/code&gt; instead of &lt;code&gt;\\&lt;/code&gt; as newline command, which also can be applied to the test example of matrix. But I think typing 6 &lt;code&gt;\&lt;/code&gt; is quite tedious. Is there any concise solution?&lt;/p&gt;

&lt;p&gt;$$
\begin{eqnarray}
y &amp;amp;=&amp;amp; x^4 + 4      \nonumber \\&lt;br /&gt;
  &amp;amp;=&amp;amp; (x^2+2)^2 -4x^2 \nonumber \\&lt;br /&gt;
  &amp;amp;\le&amp;amp;(x^2+2)^2    \nonumber
\end{eqnarray}
$$&lt;/p&gt;

&lt;p&gt;Alternative way to display matrix correctly is to use &lt;code&gt;\\\\\\&lt;/code&gt; instead of &lt;code&gt;\\&lt;/code&gt; as newline command.
$$
\begin{matrix}
  1 &amp;amp; x &amp;amp; x^2 \\&lt;br /&gt;
  1 &amp;amp; y &amp;amp; y^2 \\&lt;br /&gt;
  1 &amp;amp; z &amp;amp; z^2 \\&lt;br /&gt;
\end{matrix}
$$&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Optimization of Disk Usage for animint</title>
      <link>http://blog.tonytsai.name/blog/2015-08-09-optimization-of-disk-usage-for-animint/</link>
      <pubDate>Sun, 09 Aug 2015 23:44:46 -0400</pubDate>
      
      <guid>http://blog.tonytsai.name/blog/2015-08-09-optimization-of-disk-usage-for-animint/</guid>
      <description>

&lt;h2 id=&#34;problem&#34;&gt;Problem&lt;/h2&gt;

&lt;p&gt;The easy test for becoming a potential student of &lt;a href=&#34;https://github.com/rstats-gsoc/gsoc2015/wiki/Animint&#34; target=&#34;_blank&#34;&gt;animint project&lt;/a&gt; for GSoC 2015 is to use &lt;a href=&#34;https://github.com/tdhock/animint&#34; target=&#34;_blank&#34;&gt;animint&lt;/a&gt; to visualize some data from your domain of expertise, and upload your visualization to the web using &lt;code&gt;animint2gist&lt;/code&gt;. I used animint to visualize the data from the &lt;a href=&#34;http://gis.cdc.gov/grasp/fluview/main.html&#34; target=&#34;_blank&#34;&gt;CDC&amp;rsquo;s State-level FluView&lt;/a&gt;, which is a main data source of my Ph.D. &lt;a href=&#34;https://github.com/caijun/res4flu#databases-for-influenza-research&#34; target=&#34;_blank&#34;&gt;influenza research&lt;/a&gt;. The script for generating the FluView viz can be found in &lt;a href=&#34;https://github.com/caijun/AnimintTest&#34; target=&#34;_blank&#34;&gt;AnimintTest&lt;/a&gt; repository.&lt;/p&gt;

&lt;p&gt;As shown in following figure, the FluView viz is comprised of two ggplots: the top is a heatmap, and the bottom is a map of US lower 48 states. In the top heatmap, &lt;code&gt;WEEKEND&lt;/code&gt; is a selection variable. As the selected &lt;code&gt;WEEKEND&lt;/code&gt; changes, the bottom state map is re-drawn to show the ILI activity levels across US lower 48 states at the selected &lt;code&gt;WEEKEND&lt;/code&gt;, whose colors are mapping to the ILI activity levels.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://tonytsai.name/materials/FluView.png&#34; alt=&#34;Screenshot of FluView viz&#34; /&gt;&lt;/p&gt;

&lt;p&gt;However, there are some problems when using the current animint package to produce above FluView viz. First, after making the FluView viz, it took long time for &lt;code&gt;animint2gist&lt;/code&gt; to upload the viz to &lt;a href=&#34;http://bl.ocks.org&#34; target=&#34;_blank&#34;&gt;bl.ocks.org&lt;/a&gt;, but still failed.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;system.time&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;animint2gist&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;viz&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; out.dir &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;FluView-old&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
Loading required namespace&lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; gistr
Error &lt;span style=&#34;color: #268BD2&#34;&gt;in&lt;/span&gt; res&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;errors &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; object of type &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;externalptr&amp;#39;&lt;/span&gt; is not subsettable
Timing stopped at&lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;148.793&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;16.205&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;412.56&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;So I had to upload the FluView viz to &lt;a href=&#34;http://tonytsai.name/FluView-old/index.html&#34; target=&#34;_blank&#34;&gt;my personal website&lt;/a&gt; to demonstrate it to &lt;a href=&#34;https://github.com/tdhock&#34; target=&#34;_blank&#34;&gt;Toby Hocking&lt;/a&gt;, the creator of animint package. Second, when you play with the FluView viz, you will feel strongly that the interactivity experience of FluView viz is less responsive. After clicking on the top heatmap,  it took long time for the viz to update the bottom map to show the ILI activity levels at selected &lt;code&gt;WEEKEND&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Actually, these problems are caused by the large filesize of chunks generated by animint. Using the current animint package, the FluView viz took about &lt;strong&gt;219&lt;/strong&gt; MB of chunks, which was too large for &lt;code&gt;animint2gist&lt;/code&gt; to upload it. Individual chunk of &lt;code&gt;geom4_polygon_stateMap&lt;/code&gt; for each &lt;code&gt;WEEKEND&lt;/code&gt; had a filesize of &lt;strong&gt;708&lt;/strong&gt; KB, which also took a while for the browser to load it and made the viz less responsive.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ ls FluView-old/*.tsv&lt;span style=&#34;color: #93A1A1&#34;&gt;|&lt;/span&gt;wc -l
     316
$ du -hsc FluView-old/*.tsv&lt;span style=&#34;color: #93A1A1&#34;&gt;|&lt;/span&gt;tail
708K	FluView-old/geom4_polygon_stateMap_chunk91.tsv
708K	FluView-old/geom4_polygon_stateMap_chunk92.tsv
708K	FluView-old/geom4_polygon_stateMap_chunk93.tsv
708K	FluView-old/geom4_polygon_stateMap_chunk94.tsv
708K	FluView-old/geom4_polygon_stateMap_chunk95.tsv
708K	FluView-old/geom4_polygon_stateMap_chunk96.tsv
708K	FluView-old/geom4_polygon_stateMap_chunk97.tsv
708K	FluView-old/geom4_polygon_stateMap_chunk98.tsv
708K	FluView-old/geom4_polygon_stateMap_chunk99.tsv
219M	total
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Therefore, the disk usage of current animint package need to be optimized, at least for the FluView viz. As stated in the OPTIMIZATION category from the &lt;strong&gt;TODO list of features to implement&lt;/strong&gt; in the &lt;a href=&#34;https://github.com/tdhock/animint/blob/master/README.md&#34; target=&#34;_blank&#34;&gt;README&lt;/a&gt; file of animint package, optimizations in terms of compiler/render speed, disk usage, memory, etc make animint easier to visualize large data sets, for example, the CDC FluView dataset. Hence, optimizations for animint become key project goals for my animint &lt;a href=&#34;https://github.com/caijun/AnimintTest/blob/master/gsoc-r-2015-animint-proposal.md&#34; target=&#34;_blank&#34;&gt;project proposal&lt;/a&gt; for GSoC-R 2015.&lt;/p&gt;

&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;

&lt;p&gt;By inspecting the chunk files of FluView viz, we can see that each chunk of &lt;code&gt;geom4_polygon_stateMap&lt;/code&gt; has saved the coordinates and fill colours of state polygons. Since using ggplot2 to draw maps, spatial objects are stored in data.frame, in which each row consists of &lt;strong&gt;coordinates&lt;/strong&gt; of a vertex and &lt;strong&gt;attributes&lt;/strong&gt; of the spatial object that the vertex belongs to (e.g. fill colours of state polygons in the FluView viz); however, in the FluView viz, the number of vertex (11527) to draw the borders of state polygons are far more than the number of state polygons (62 other than 48 because holes in some polygons), which leads to the repeated storage of attributes. By virtue of my background of GIS (Geographic Information System), I know the best spatial data storing approach is like &lt;a href=&#34;https://en.wikipedia.org/wiki/Shapefile&#34; target=&#34;_blank&#34;&gt;shapefile&lt;/a&gt;, one advantage of which is to separately store the shape and attribute in .shp file and .dbf table, avoiding the repeated storage of shape coordinates and simplying the storage of object attributes. So for spatial objects such as the FluView viz, I proposed the new chunk storing strategy as shown in the topleft panel of following figure.&lt;/p&gt;

&lt;p&gt;By discussing with Toby Hocking, for non-spatial objects such as the frequent used &lt;a href=&#34;http://bl.ocks.org/caijun/raw/c7899e4c614d0fe37423/&#34; target=&#34;_blank&#34;&gt;WorldBank viz&lt;/a&gt;, there are also redundant information (common columns) across chunks. Hence, the common columns and varied columns should also be saved separately to chunk files. A new chunk storing strategy for non-spatial objects shown in topright panel of following figure is proposed.&lt;/p&gt;









&lt;span class=&#34;caption-wrapper&#34;&gt;
  &lt;img class=&#34;caption&#34; src=&#34;http://tonytsai.name/materials/animint.png&#34; title=&#34;New chunk storing strategy&#34; alt=&#34;New chunk storing strategy&#34;&gt;
  &lt;span class=&#34;caption-text&#34;&gt;New chunk storing strategy&lt;/span&gt;
&lt;/span&gt;


&lt;p&gt;For generality, the optimization of disk uage for animint can be abstracted into the new chunk storing strategy shown in the bottom panel of above figure. The columns of each chunk are divided into three categories: &lt;strong&gt;common&lt;/strong&gt; columns across chunks, &lt;strong&gt;varied&lt;/strong&gt; columns across chunks, and &lt;strong&gt;key&lt;/strong&gt; columns. The common and key columns are saved into an &lt;strong&gt;common&lt;/strong&gt; chunk, which is an extra added chunk; the varied and key columns are saved to &lt;strong&gt;varied&lt;/strong&gt; chunks, the number of which are the same. Key columns are saved to both common chunk and varied chunks to ensure that the renderer can recover the original chunk through joining common chunk to varied chunks by key columns. The key columns are expressed as &lt;code&gt;union(group, nest_order)&lt;/code&gt;, of which &lt;code&gt;group&lt;/code&gt; is the column name that represents the row index before splitting the original chunk, and &lt;code&gt;nest_order&lt;/code&gt; is a variable that is used for grouping rows in (both common and varied) chunks into a hierarchical tree structure in the renderer. It&amp;rsquo;s notable that &lt;code&gt;group&lt;/code&gt; has already been included in the &lt;code&gt;nest_order&lt;/code&gt; variable for some visualizations.&lt;/p&gt;

&lt;p&gt;Therefore, the implements of the optimization for animint can be simplified into three main parts:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Determining the common columns across chunks in the compiler&lt;/li&gt;
&lt;li&gt;Formalising the key columns in the compiler&lt;/li&gt;
&lt;li&gt;Recovering original chunks through joining common chunk into varied chunks by key columns in the renderer&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;To further reduce writing time and disk space, any rows with NA from varied chunks are not saved to tsv files. A benefit of deleting NA values in the compiler is to fix the warning of &lt;strong&gt;Unexpected value NaN parsing attributes&lt;/strong&gt; from D3.js in the renderer.&lt;/p&gt;

&lt;h2 id=&#34;improvement&#34;&gt;Improvement&lt;/h2&gt;

&lt;p&gt;The pull request of &lt;a href=&#34;https://github.com/tdhock/animint/pull/76&#34; target=&#34;_blank&#34;&gt;optimizations to save disk space&lt;/a&gt; implements the new version of animint compiler and renderer based on the new chunk storing strategy.&lt;/p&gt;

&lt;p&gt;For the above FluView viz, though an extra common chunk is generated by the new animint compiler, the viz takes only &lt;strong&gt;4.4&lt;/strong&gt; MB, which is almost $1/50$ of the original filesize produced by the old animint compiler. Individual varied chunk of &lt;code&gt;geom4_polygon_stateMap&lt;/code&gt; for each &lt;code&gt;WEEKEND&lt;/code&gt; has a filesize of only &lt;strong&gt;4&lt;/strong&gt; KB, which is almost $1/180$ of the original filesize. The sharp descrease in varied chunk filesize  definitely reduces the loading time for the browser and makes the viz responsive.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ ls FluView-new/*.tsv&lt;span style=&#34;color: #93A1A1&#34;&gt;|&lt;/span&gt;wc -l
     317
$ du -hsc FluView-new/*.tsv&lt;span style=&#34;color: #93A1A1&#34;&gt;|&lt;/span&gt;tail
4.0K	FluView-new/geom4_polygon_stateMap_chunk92.tsv
4.0K	FluView-new/geom4_polygon_stateMap_chunk93.tsv
4.0K	FluView-new/geom4_polygon_stateMap_chunk94.tsv
4.0K	FluView-new/geom4_polygon_stateMap_chunk95.tsv
4.0K	FluView-new/geom4_polygon_stateMap_chunk96.tsv
4.0K	FluView-new/geom4_polygon_stateMap_chunk97.tsv
4.0K	FluView-new/geom4_polygon_stateMap_chunk98.tsv
4.0K	FluView-new/geom4_polygon_stateMap_chunk99.tsv
588K	FluView-new/geom4_polygon_stateMap_chunk_common.tsv
4.4M	total
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The save chunk process of new animint compiler becomes more complex than the old one, but there are less chunk contents to write onto disk. As a result of trade-off, the compiling speed of the new animint compiler doesn&amp;rsquo;t increase dramatically comparing to the old one.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;system.time&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;animint2dir&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;viz&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; out.dir &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;FluView-old&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
   user  system elapsed 
&lt;span style=&#34;color: #2AA198&#34;&gt;115.830&lt;/span&gt;  &lt;span style=&#34;color: #2AA198&#34;&gt;12.223&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;128.720&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;system.time&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;animint2dir&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;viz&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; out.dir &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;FluView-new&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
   user  system elapsed 
&lt;span style=&#34;color: #2AA198&#34;&gt;115.347&lt;/span&gt;  &lt;span style=&#34;color: #2AA198&#34;&gt;13.833&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;130.460&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now we can successfully post the FluView viz on gist by &lt;code&gt;animint2gist&lt;/code&gt;, which takes almost the same amount of time with &lt;code&gt;animint2dir&lt;/code&gt;. Playing with the &lt;a href=&#34;http://bl.ocks.org/caijun/raw/7ff9b0c53f78d0491366/&#34; target=&#34;_blank&#34;&gt;result&lt;/a&gt;, you can obviously feel that the interactivity experience has been improved. After clicking on the top heatmap, the bottom state map is updated in time that we can bear.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;system.time&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;animint2gist&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;viz&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; out.dir &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;FluView-new&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
   user  system elapsed 
 &lt;span style=&#34;color: #2AA198&#34;&gt;98.872&lt;/span&gt;  &lt;span style=&#34;color: #2AA198&#34;&gt;17.935&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;134.384&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;For non-spatial objects, the new animint compiler can also reduce disk usage. For example the &lt;a href=&#34;http://bl.ocks.org/caijun/raw/c7899e4c614d0fe37423/&#34; target=&#34;_blank&#34;&gt;WorldBank viz&lt;/a&gt;, the disk space of chunk tsvs is reduced from &lt;strong&gt;3.6&lt;/strong&gt; MB to &lt;strong&gt;2.8&lt;/strong&gt; MB.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ du -hsc WorldBank-old/*.tsv&lt;span style=&#34;color: #93A1A1&#34;&gt;|&lt;/span&gt;tail
 16K	WorldBank-old/geom2_text_scatter_chunk52.tsv
8.0K	WorldBank-old/geom2_text_scatter_chunk53.tsv
 16K	WorldBank-old/geom2_text_scatter_chunk6.tsv
 16K	WorldBank-old/geom2_text_scatter_chunk7.tsv
 16K	WorldBank-old/geom2_text_scatter_chunk8.tsv
 16K	WorldBank-old/geom2_text_scatter_chunk9.tsv
4.0K	WorldBank-old/geom3_text_scatter_chunk1.tsv
4.0K	WorldBank-old/geom4_tallrect_ts_chunk1.tsv
1.0M	WorldBank-old/geom5_line_ts_chunk1.tsv
3.6M	total

$ du -hsc WorldBank-new/*.tsv&lt;span style=&#34;color: #93A1A1&#34;&gt;|&lt;/span&gt;tail
 12K	WorldBank-new/geom2_text_scatter_chunk52.tsv
 12K	WorldBank-new/geom2_text_scatter_chunk6.tsv
 12K	WorldBank-new/geom2_text_scatter_chunk7.tsv
 12K	WorldBank-new/geom2_text_scatter_chunk8.tsv
 12K	WorldBank-new/geom2_text_scatter_chunk9.tsv
8.0K	WorldBank-new/geom2_text_scatter_chunk_common.tsv
4.0K	WorldBank-new/geom3_text_scatter_chunk1.tsv
4.0K	WorldBank-new/geom4_tallrect_ts_chunk1.tsv
948K	WorldBank-new/geom5_line_ts_chunk1.tsv
2.8M	total
&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&#34;future-work&#34;&gt;Future Work&lt;/h2&gt;

&lt;p&gt;For small dataset like WorldBank viz, the animation works well for the new animint compiler and renderer; however, adding &lt;code&gt;time = list(variable = &amp;quot;WEEKEND&amp;quot;, ms = 3000), duration = list(WEEKEND = 1000)&lt;/code&gt; to the FluView viz, the new renderer still doesn&amp;rsquo;t provide smooth transitions between animation frames at different &lt;code&gt;WEENEND&lt;/code&gt; with varied chunks small enough. This is because how the renderer draws state map hasn&amp;rsquo;t been optimized for the new chunk storing strategy. Actually, comparing to the old one, an extra step of joining common chunk into all varied chunks by key columns is added to the new renderer during chunk downloading process.&lt;/p&gt;

&lt;p&gt;For each animation frame, the polygons of state map are constant and only the fill colours for polygons change. Hence, the best rendering approach is to separate geom drawing and attribute rendering. The renderer draws polygons of state map only at the initial rendering step using the common chunk, and for next animation frames only the fill colours for polygons are re-drawn only using corresponding varied chunks.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Operator for Extracting Named List Elements to Variables</title>
      <link>http://blog.tonytsai.name/blog/2015-05-21-operator-for-extracting-named-list-elements-to-variables/</link>
      <pubDate>Thu, 21 May 2015 23:44:46 -0400</pubDate>
      
      <guid>http://blog.tonytsai.name/blog/2015-05-21-operator-for-extracting-named-list-elements-to-variables/</guid>
      <description>&lt;p&gt;In routine data analysis, I often need to convert list elements into variables. For exampple, when I create a function returning multiple values and I would like to use those values as variables separately, as only one object can be returned by the function, the common way to accomplish this task is that multiple values are combined as a list returned by the function, elements of interest are then extracted and assigned to variables. The following codes describe the process.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #586E75&#34;&gt;# define a function returning a matrix and a numeric&lt;/span&gt;
fun &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;list&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;a &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;matrix&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; nr &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; nc &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;),&lt;/span&gt; b &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;

&lt;span style=&#34;color: #586E75&#34;&gt;# call function to return a list containing multiple returning values&lt;/span&gt;
r &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; fun&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;# extract elements of interest and assgin them to variables&lt;/span&gt;
x &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; r&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;a
y &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; r&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;b
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;However, when numerous values have to be returned and lots of assignments have to be written down, the process is really cumbersome. One may argue that it&amp;rsquo;s ok to directly use &lt;code&gt;list$element&lt;/code&gt; as a variable, but it can&amp;rsquo;t satisify my geek desire that code should be succinct and is easy to read. The best way is to directly return variables &lt;code&gt;a&lt;/code&gt; and &lt;code&gt;b&lt;/code&gt; in above case, which is the exact way that MATLAB returns multiple values. Rewrite above example in MATLAB.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;# &lt;span style=&#34;color: #93A1A1&#34;&gt;define&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;function&lt;/span&gt;
&lt;span style=&#34;color: #719e07&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt; &lt;/span&gt;[a, b] &lt;span style=&#34;color: #93A1A1&#34;&gt;= &lt;/span&gt;&lt;span style=&#34;color: #268BD2&#34;&gt;fun&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;a(:,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;b&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;

# &lt;span style=&#34;color: #93A1A1&#34;&gt;call&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;function&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;[a,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;b]&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;fun()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Therefore, we could customize a similar operator in R to implement such assignment. Fortunately, G. Grothendieck has done such &lt;a href=&#34;http://stackoverflow.com/questions/1826519/function-returning-more-than-one-value&#34; target=&#34;_blank&#34;&gt;work&lt;/a&gt; ten years ago. He firstly creates a variable named &lt;code&gt;list&lt;/code&gt;, which is a structure with class attribute of &lt;code&gt;result&lt;/code&gt;, then defines an S3 method &lt;code&gt;[&amp;lt;-.result&lt;/code&gt; of class &lt;code&gt;result&lt;/code&gt;. His solution is as follows&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;list&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;structure&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #CB4B16&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; class &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;result&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;[&amp;lt;-.result&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;x&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;...&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; value&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
   args &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;as.list&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;match.call&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;())&lt;/span&gt;
   args &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;length&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))]&lt;/span&gt;
   &lt;span style=&#34;color: #719e07&#34;&gt;length&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;value&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;length&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
   &lt;span style=&#34;color: #268BD2&#34;&gt;for&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #268BD2&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;seq&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;along &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
     a &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]]&lt;/span&gt;
     &lt;span style=&#34;color: #268BD2&#34;&gt;if&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;!missing&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;a&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;eval.parent&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;substitute&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;a &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; v&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;list&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;a &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; a&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; v &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; value&lt;span style=&#34;color: #93A1A1&#34;&gt;[[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]])))&lt;/span&gt;
   &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
   x
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Applying G. Grothendieck&amp;rsquo;s solution to the above case is as simple as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #586E75&#34;&gt;# extract all variables&lt;/span&gt;
&lt;span style=&#34;color: #DC322F&#34;&gt;list&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;a&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; b&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; fun&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt;

&lt;span style=&#34;color: #586E75&#34;&gt;# extract first variable without renaming&lt;/span&gt;
&lt;span style=&#34;color: #DC322F&#34;&gt;list&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;a&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; fun&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt;

&lt;span style=&#34;color: #586E75&#34;&gt;# extract second variable with renaming&lt;/span&gt;
&lt;span style=&#34;color: #DC322F&#34;&gt;list&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[,&lt;/span&gt; y&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; fun&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt;

&lt;span style=&#34;color: #586E75&#34;&gt;# extract all variable with renaming&lt;/span&gt;
&lt;span style=&#34;color: #DC322F&#34;&gt;list&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;x&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; y&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; fun&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This operator is exactly what I want; however, it can be improved in two cases: one is that there are numerous variables to be extracted, the other is that only elements of interest are explicitly extracted while the other elements can be extracted in a silent way. Hence, I modified &lt;code&gt;[&amp;lt;-.result()&lt;/code&gt; to make it more easy to use in these two cases. The following are modified codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;[&amp;lt;-.result&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;x&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;...&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; value&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  nv &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;names&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;value&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
  args &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;as.list&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;match.call&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;())&lt;/span&gt;
  args &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;length&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))]&lt;/span&gt;
  all &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;FALSE&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;all&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;%in%&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;names&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    all &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[[&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;all&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]]&lt;/span&gt;
    &lt;span style=&#34;color: #719e07&#34;&gt;stopifnot&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;is.logical&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;all&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
    &lt;span style=&#34;color: #719e07&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;all&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;NULL&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
  drop &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;TRUE&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;drop&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;%in%&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;names&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    drop &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[[&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;drop&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]]&lt;/span&gt;
    &lt;span style=&#34;color: #719e07&#34;&gt;stopifnot&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;is.logical&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;drop&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
    &lt;span style=&#34;color: #719e07&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;drop&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;NULL&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;

  &lt;span style=&#34;color: #268BD2&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;length&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; args &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;sapply&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;nv&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;as.name&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #268BD2&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;seq&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;along &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    a &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]]&lt;/span&gt;
    &lt;span style=&#34;color: #268BD2&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;missing&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;a&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
      &lt;span style=&#34;color: #268BD2&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;all&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; a &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;as.name&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;nv&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;])&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;next&lt;/span&gt;
    &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
    &lt;span style=&#34;color: #268BD2&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;drop&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; v &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;drop&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;value&lt;span style=&#34;color: #93A1A1&#34;&gt;[[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]])&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;else&lt;/span&gt; v &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; value&lt;span style=&#34;color: #93A1A1&#34;&gt;[[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]]&lt;/span&gt;
    &lt;span style=&#34;color: #719e07&#34;&gt;eval.parent&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;substitute&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;a &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; v&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;list&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;a &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; a&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; v &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; v&lt;span style=&#34;color: #93A1A1&#34;&gt;)))&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
  x
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;My modification not only keeps the usages created by G. Grothendieck, but also adds two extra parameters (&lt;code&gt;all&lt;/code&gt; and &lt;code&gt;drop&lt;/code&gt;) and changes the returning results of &lt;code&gt;list[] &amp;lt;- value&lt;/code&gt;.In G. Grothendieck&amp;rsquo;s solution, calling &lt;code&gt;list[] &amp;lt;- fun()&lt;/code&gt; will not return any variables, but in my version, it will return all varaibles correspoding the list elements. The advantage of my solution is to avoid inputting all variables when there are two numerous named list elements.&lt;/p&gt;

&lt;p&gt;The default for parameter &lt;code&gt;all&lt;/code&gt; is &lt;code&gt;FALSE&lt;/code&gt; to keep the calling way as G. Grothendieck. Setting &lt;code&gt;all = TRUE&lt;/code&gt; can extract all list elements to variables even you only input partial variable names. The elements without inputting variable names will use the element names as variable names. This is the reason why the list elements are named. This sort usage can reduce amount of inputting variable names in case extra list elements needs to be extracted to variables.&lt;/p&gt;

&lt;p&gt;Notice that in above example, list element &lt;code&gt;a&lt;/code&gt; is a matrix with the second dimenion which has only one level. Adding parameter &lt;code&gt;drop&lt;/code&gt; can simutaniously drop the redundant dimension during the variable extraction. This sort usage avoids an extra &lt;code&gt;drop()&lt;/code&gt; operation to keep the extracted variable simple. The default value for argument &lt;code&gt;drop&lt;/code&gt; is &lt;code&gt;TRUE&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The following codes demonstrate the new usages of modified &lt;code&gt;[&amp;lt;-.result()&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #586E75&#34;&gt;# implicitly extract all variabes without renaming. note that by default&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;# dimensions are dropped.&lt;/span&gt;
&lt;span style=&#34;color: #DC322F&#34;&gt;list&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; fun&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# return a = 1, b = 2&lt;/span&gt;

&lt;span style=&#34;color: #586E75&#34;&gt;# set drop to FALSE without dimension dropping&lt;/span&gt;
&lt;span style=&#34;color: #DC322F&#34;&gt;list&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;x&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; drop &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;FALSE&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; fun&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# return matrix x&lt;/span&gt;

&lt;span style=&#34;color: #586E75&#34;&gt;# set all to TRUE to extract all elements.&lt;/span&gt;
&lt;span style=&#34;color: #DC322F&#34;&gt;list&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;x&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; all &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;TRUE&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; fun&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# return x = 1, b = 2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The modified codes have been packaged into my package &lt;a href=&#34;https://github.com/caijun/TTmisc&#34; target=&#34;_blank&#34;&gt;TTmisc&lt;/a&gt;. For more examples of usage and details refer to the repository &lt;a href=&#34;(https://github.com/caijun/TTmisc)&#34; target=&#34;_blank&#34;&gt;TTmisc&lt;/a&gt; on my github.&lt;/p&gt;

&lt;p&gt;At last, it is important to note that the right side of assignment can be just a list object with named elements. It is not necessary to be a function calling. Here, I use function calling only for demonstration.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Resources for Influenza Research</title>
      <link>http://blog.tonytsai.name/blog/2015-05-10-resources-for-influenza-research/</link>
      <pubDate>Sun, 10 May 2015 23:44:46 -0400</pubDate>
      
      <guid>http://blog.tonytsai.name/blog/2015-05-10-resources-for-influenza-research/</guid>
      <description>

&lt;p&gt;Today I made a list of resources for influenza research. I will keep updating this list as my influenza research goes further. The up-to-date version can be found on my &lt;a href=&#34;https://github.com/caijun/res4flu&#34; target=&#34;_blank&#34;&gt;github&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;contents&#34;&gt;Contents&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#infectious-diseases-epidemiology&#34;&gt;Infectious Diseases Epidemiology&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#modeling-infectious-diseases&#34;&gt;Modeling Infectious Diseases&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#topics-and-keywords&#34;&gt;Topics and Keywords&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#ecology-and-evolution-of-influenza&#34;&gt;Ecology and Evolution of Influenza&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#seasonality-of-influenza&#34;&gt;Seasonality of Influenza&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#dynamics-of-influenza&#34;&gt;Dynamics of Influenza&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#influenza-transmission&#34;&gt;Influenza Transmission&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#influenza-forecasting&#34;&gt;Influenza Forecasting&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#digital-detection-of-influenza&#34;&gt;Digital Detection of Influenza&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#databases-for-influenza-research&#34;&gt;Databases for Influenza Research&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#workshops-and-conferences&#34;&gt;Workshops and Conferences&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#moocs&#34;&gt;MOOCs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#contributing&#34;&gt;Contributing&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;topics-and-keywords&#34;&gt;Topics and Keywords&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://en.wikipedia.org/wiki/Influenza&#34; target=&#34;_blank&#34;&gt;Influenza&lt;/a&gt; | Flu&lt;/li&gt;
&lt;li&gt;Pandemic (Antigenic Shift) vs. Epidemic (Antigenic Drift)&lt;/li&gt;
&lt;li&gt;Epidemiology of Influenza&lt;/li&gt;
&lt;li&gt;Modeling Influenza

&lt;ul&gt;
&lt;li&gt;Transmission&lt;/li&gt;
&lt;li&gt;Forecasting&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Surveillence of Influenza&lt;/li&gt;
&lt;li&gt;Ecology of Influenza&lt;/li&gt;
&lt;li&gt;Evolution of Influenza

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://en.wikipedia.org/wiki/Phylogeography&#34; target=&#34;_blank&#34;&gt;Phylogeography&lt;/a&gt;
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;infectious-diseases-epidemiology&#34;&gt;Infectious Diseases Epidemiology&lt;/h2&gt;

&lt;p&gt;&lt;em&gt;Textbooks&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Gordis, L. (2013). &lt;a href=&#34;http://www.amazon.com/Epidemiology-STUDENT-CONSULT-Online-Access/dp/145573733X&#34; target=&#34;_blank&#34;&gt;Epidemiology&lt;/a&gt;. Elsevier: Saunders.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;modeling-infectious-diseases&#34;&gt;Modeling Infectious Diseases&lt;/h2&gt;

&lt;p&gt;&lt;em&gt;Textbooks&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Anderson, R. M., &amp;amp; May, R. M. (1991). &lt;a href=&#34;http://www.amazon.com/Infectious-Diseases-Humans-Dynamics-Publications/dp/019854040X&#34; target=&#34;_blank&#34;&gt;Infectious Diseases of Humans: Dynamics and Control&lt;/a&gt;. Oxford: Oxford university press.&lt;/li&gt;
&lt;li&gt;Keeling, M. J., &amp;amp; Rohani, P. (2008). &lt;a href=&#34;http://www.amazon.com/Modeling-Infectious-Diseases-Humans-Animals/dp/0691116172/&#34; target=&#34;_blank&#34;&gt;Modeling Infectious Diseases in Humans and Animals&lt;/a&gt;. Princeton University Press.&lt;/li&gt;
&lt;li&gt;Sattenspiel, L. (2009). &lt;a href=&#34;http://www.amazon.com/Geographic-Spread-Infectious-Diseases-Computational/dp/069112132X/&#34; target=&#34;_blank&#34;&gt;The Geographic Spread of Infectious Diseases: Models and Applications&lt;/a&gt;. Princeton University Press.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;Review Papers&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Heesterbeek, H., Anderson, R. M., Andreasen, V., Bansal, S., De Angelis, D., Dye, C., &amp;hellip; &amp;amp; Viboud, C. (2015). &lt;a href=&#34;http://www.sciencemag.org/content/347/6227/aaa4339.short&#34; target=&#34;_blank&#34;&gt;Modeling Infectious Disease Dynamics in the Complex Landscape of Global Health&lt;/a&gt;. Science, 347(6227), aaa4339.&lt;/li&gt;
&lt;li&gt;A Special Issue of &lt;em&gt;Epidemics&lt;/em&gt; on &lt;a href=&#34;http://www.sciencedirect.com/science/journal/17554365/10&#34; target=&#34;_blank&#34;&gt;Challenges in Modelling Infectious Disease Dynamics&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Grassly, N. C., &amp;amp; Fraser, C. (2008). &lt;a href=&#34;http://www.nature.com/nrmicro/journal/v6/n6/full/nrmicro1845.html&#34; target=&#34;_blank&#34;&gt;Mathematical Models of Infectious Disease Transmission&lt;/a&gt;. Nature Reviews Microbiology, 6(6), 477-487.&lt;/li&gt;
&lt;li&gt;Hethcote, H. W. (2000). &lt;a href=&#34;http://epubs.siam.org/doi/abs/10.1137/S0036144500371907&#34; target=&#34;_blank&#34;&gt;The Mathematics of Infectious Diseases&lt;/a&gt;. SIAM review, 42(4), 599-653.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;ecology-and-evolution-of-influenza&#34;&gt;Ecology and Evolution of Influenza&lt;/h2&gt;

&lt;p&gt;&lt;em&gt;Textbook&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Webster, R. G., Monto, A. S., Braciale, T. J., &amp;amp; Lamb, R. A. (2014). &lt;a href=&#34;http://www.amazon.com/Textbook-Influenza-Robert-G-Webster/dp/0470670487/&#34; target=&#34;_blank&#34;&gt;Textbook of Influenza&lt;/a&gt;. John Wiley &amp;amp; Sons.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;Review Papers&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Nelson, M. I., &amp;amp; Holmes, E. C. (2007). &lt;a href=&#34;http://www.nature.com/nrg/journal/v8/n3/abs/nrg2053.html&#34; target=&#34;_blank&#34;&gt;The Evolution of Epidemic Influenza&lt;/a&gt;. Nature reviews genetics, 8(3), 196-205.&lt;/li&gt;
&lt;li&gt;Earn, D. J., Dushoff, J., &amp;amp; Levin, S. A. (2002). &lt;a href=&#34;http://www.sciencedirect.com/science/article/pii/S0169534702025028&#34; target=&#34;_blank&#34;&gt;Ecology and Evolution of the Flu&lt;/a&gt;. Trends in ecology &amp;amp; evolution, 17(7), 334-340.&lt;/li&gt;
&lt;li&gt;Potter, C. W. (2001). &lt;a href=&#34;http://onlinelibrary.wiley.com/doi/10.1046/j.1365-2672.2001.01492.x/full&#34; target=&#34;_blank&#34;&gt;A History of Influenza&lt;/a&gt;. Journal of applied microbiology, 91(4), 572-579.&lt;/li&gt;
&lt;li&gt;Cox, N. J., &amp;amp; Subbarao, K. (2000). &lt;a href=&#34;http://www.annualreviews.org/doi/abs/10.1146/annurev.med.51.1.407&#34; target=&#34;_blank&#34;&gt;Global Epidemiology of Influenza: Past and Present&lt;/a&gt;. Annual review of medicine, 51(1), 407-421.&lt;/li&gt;
&lt;li&gt;Webster, R. G., Bean, W. J., Gorman, O. T., Chambers, T. M., &amp;amp; Kawaoka, Y. (1992). &lt;a href=&#34;http://mmbr.asm.org/content/56/1/152.short&#34; target=&#34;_blank&#34;&gt;Evolution and Ecology of Influenza A Viruses&lt;/a&gt;. Microbiological reviews, 56(1), 152-179.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;seasonality-of-influenza&#34;&gt;Seasonality of Influenza&lt;/h2&gt;

&lt;p&gt;&lt;em&gt;Review Papers&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Rates, C. (2011). &lt;a href=&#34;http://ehp.niehs.nih.gov/1002383/&#34; target=&#34;_blank&#34;&gt;Global Influenza Seasonality: Reconciling Patterns Across Temperate and Tropical Regions&lt;/a&gt;. Environmental health perspectives, 119(4), 439.&lt;/li&gt;
&lt;li&gt;Fuhrmann, C. (2010). &lt;a href=&#34;http://onlinelibrary.wiley.com/doi/10.1111/j.1749-8198.2010.00343.x/full&#34; target=&#34;_blank&#34;&gt;The Effects of Weather and Climate on the Seasonality of Influenza: What We Know and What We Need to Know&lt;/a&gt;. Geography Compass, 4(7), 718-730.&lt;/li&gt;
&lt;li&gt;Lipsitch, M., &amp;amp; Viboud, C. (2009). &lt;a href=&#34;http://www.pnas.org/content/106/10/3645.short&#34; target=&#34;_blank&#34;&gt;Influenza Seasonality: Lifting the Fog&lt;/a&gt;. Proceedings of the National Academy of Sciences, 106(10), 3645-3646.&lt;/li&gt;
&lt;li&gt;Lofgren, E., Fefferman, N. H., Naumov, Y. N., Gorski, J., &amp;amp; Naumova, E. N. (2007). &lt;a href=&#34;http://jvi.asm.org/content/81/11/5429.short&#34; target=&#34;_blank&#34;&gt;Influenza Seasonality: Underlying Causes and Modeling Theories&lt;/a&gt;. Journal of virology, 81(11), 5429-5436.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;dynamics-of-influenza&#34;&gt;Dynamics of Influenza&lt;/h2&gt;

&lt;h3 id=&#34;influenza-transmission&#34;&gt;Influenza Transmission&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;Classical Paper&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Rvachev, L. A., &amp;amp; Longini, I. M. (1985). &lt;a href=&#34;http://www.sciencedirect.com/science/article/pii/0025556485900641&#34; target=&#34;_blank&#34;&gt;A Mathematical Model for the Global Spread of Influenza&lt;/a&gt;. Mathematical biosciences, 75(1), 3-22.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;influenza-forecasting&#34;&gt;Influenza Forecasting&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;Review Papers&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Nsoesie, E. O., Brownstein, J. S., Ramakrishnan, N., &amp;amp; Marathe, M. V. (2014). &lt;a href=&#34;http://onlinelibrary.wiley.com/doi/10.1111/irv.12226/full&#34; target=&#34;_blank&#34;&gt;A Systematic Review of Studies on Forecasting the Dynamics of Influenza Outbreaks&lt;/a&gt;. Influenza and other respiratory viruses, 8(3), 309-316.&lt;/li&gt;
&lt;li&gt;Chretien, J. P., George, D., Shaman, J., Chitale, R. A., &amp;amp; McKenzie, F. E. (2014). &lt;a href=&#34;http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0094130&#34; target=&#34;_blank&#34;&gt;Influenza Forecasting in Human Populations: a Scoping Review&lt;/a&gt;. PloS one, 9(4), e94130.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;digital-detection-of-influenza&#34;&gt;Digital Detection of Influenza&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;Review Paper&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Salathe, M., Bengtsson, L., Bodnar, T. J., Brewer, D. D., Brownstein, J. S., Buckee, C., &amp;hellip; &amp;amp; Vespignani, A. (2012). &lt;a href=&#34;http://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1002616&#34; target=&#34;_blank&#34;&gt;Digital Epidemiology&lt;/a&gt;. PLoS computational biology, 8(7), e1002616.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;Classical Paper&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Ginsberg, J., Mohebbi, M. H., Patel, R. S., Brammer, L., Smolinski, M. S., &amp;amp; Brilliant, L. (2009). &lt;a href=&#34;http://www.nature.com/nature/journal/v457/n7232/abs/nature07634.html&#34; target=&#34;_blank&#34;&gt;Detecting Influenza Epidemics using Search Engine Query Data&lt;/a&gt;. Nature, 457(7232), 1012-1014.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;Projects&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.google.org/flutrends/intl/en_us/&#34; target=&#34;_blank&#34;&gt;Google Flu Trends&lt;/a&gt;: using aggregated Google search data to estimate flu activity.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.healthmap.org/en/&#34; target=&#34;_blank&#34;&gt;HealthMap&lt;/a&gt;: flu &amp;amp; Ebola map | virus &amp;amp; contagious disease surveillence.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;databases-for-influenza-research&#34;&gt;Databases for Influenza Research&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.who.int/influenza/gisrs_laboratory/flunet/en/&#34; target=&#34;_blank&#34;&gt;WHO FluNet&lt;/a&gt;: a global tool for influenza virological surveillance.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.cdc.gov/flu/weekly/&#34; target=&#34;_blank&#34;&gt;Weekly U.S. Influenza Surveillance Report&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://gis.cdc.gov/grasp/fluview/fluportaldashboard.html&#34; target=&#34;_blank&#34;&gt;FluView&lt;/a&gt;: national and regional level outpatient illness and viral surveillence.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://gis.cdc.gov/grasp/fluview/main.html&#34; target=&#34;_blank&#34;&gt;FluView&lt;/a&gt;: influenza-like illness (ILI) activity level indicator determined by data reported to ILINet.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Estimated flu activity from &lt;a href=&#34;https://www.google.org/flutrends/intl/en_us/&#34; target=&#34;_blank&#34;&gt;Google Flu Trends&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.fludb.org/&#34; target=&#34;_blank&#34;&gt;Influenza Research Database (IRD)&lt;/a&gt;: global public database and analysis resource for the study of influenza viruses.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.ncbi.nlm.nih.gov/genomes/FLU/&#34; target=&#34;_blank&#34;&gt;NCBI Influenza Virus Resource&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://platform.gisaid.org/&#34; target=&#34;_blank&#34;&gt;Global Initiative on Sharing Avian Influenza Data (GISAID)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://empres-i.fao.org/eipws3g/&#34; target=&#34;_blank&#34;&gt;EMPRES Global Animal Disease Information System (EMPRES-i)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://influenza.sph.unimelb.edu.au/&#34; target=&#34;_blank&#34;&gt;FluWeb Historical Influenza Database&lt;/a&gt;: free access to a number of rare and valuable sources of data concerning past influenza outbreaks.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;workshops-and-conferences&#34;&gt;Workshops and Conferences&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.origem.info/misms/&#34; target=&#34;_blank&#34;&gt;Multinational Influenza Seasonal Mortality Study (MISMS) Workshop&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.iceid.org/&#34; target=&#34;_blank&#34;&gt;International Conference on Emerging Infectious Diseases&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.epidemics.elsevier.com/&#34; target=&#34;_blank&#34;&gt;Epidemics: International Conference on Infectious Disease Dynamics&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://eeidconference.org/&#34; target=&#34;_blank&#34;&gt;Annual Ecology and Evolution of Infectious Disease Conference&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;moocs&#34;&gt;MOOCs&lt;/h2&gt;

&lt;p&gt;&lt;em&gt;Massive open online courses&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://www.coursera.org/course/epidemics&#34; target=&#34;_blank&#34;&gt;Epidemics - the Dynamics of Infectious Diseases&lt;/a&gt;: a course provided by the Pennsylvania State University discusses about the dynamics of Malaria, HIV/AIDS, Influenza, Measles - how they emerge, how they spread around the globe, and how they can best be controlled.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://www.edx.org/course/epidemics-hkux-hku01x-0&#34; target=&#34;_blank&#34;&gt;Epidemics&lt;/a&gt;: a course provided by the University of Hong Kong covers these four topics: origins of novel pathogens; analysis of the spread of infectious diseases; medical and public health countermeasures to prevent and control epidemics; panel discussions involving leading public health experts with deep frontline experiences to share their views on risk communication, crisis management, ethics and public trust in the context of infectious disease control.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;contributing&#34;&gt;Contributing&lt;/h2&gt;

&lt;p&gt;Your contributions are always welcome!&lt;/p&gt;

&lt;p&gt;This work is distributed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License - &lt;a href=&#34;http://creativecommons.org/licenses/by-nc-sa/4.0/legalcode&#34; target=&#34;_blank&#34;&gt;CC BY-NC-SA 4.0&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Why Does the Jackknife Estimate of Standard Error Have the Factor (n-1)/n?</title>
      <link>http://blog.tonytsai.name/blog/2015-04-23-why-does-the-jackknife-estimate-of-standard-error-have-the-factor-n-1/n/</link>
      <pubDate>Thu, 23 Apr 2015 23:44:46 -0400</pubDate>
      
      <guid>http://blog.tonytsai.name/blog/2015-04-23-why-does-the-jackknife-estimate-of-standard-error-have-the-factor-n-1/n/</guid>
      <description>&lt;p&gt;Today I read &lt;strong&gt;7.2 The Jackknife&lt;/strong&gt; in &lt;a href=&#34;http://www.amazon.com/Statistical-Computing-Chapman-Hall-Series/dp/1584885459&#34; target=&#34;_blank&#34;&gt;Stastical Computing with R&lt;/a&gt; and found the explanation for why the jackknife estimate of standard error have the factor $(n-1)/n$ is unclear. I refered to &lt;a href=&#34;http://www.amazon.com/Introduction-Bootstrap-Monographs-Statistics-Probability/dp/0412042312&#34; target=&#34;_blank&#34;&gt;An Introduction to the Bootstrap&lt;/a&gt; by Bradley Efron and R. J. Tibshirani, and the &lt;a href=&#34;https://www.scss.tcd.ie/Rozenn.Dahyot/453Bootstrap/04_Jackknife.pdf&#34; target=&#34;_blank&#34;&gt;slides&lt;/a&gt; of jackknife by Rozenn Dahyot to figure out the reason. Here is my understanding for the existence of factor $(n-1)/n$.&lt;/p&gt;

&lt;p&gt;The jackknife samples are computed by leaving out one observation $x_i$ from a sample $\mathbf{x} = (x_1, x_2, \cdots, x_n)$ at a time:
$$
\mathbf{x}_{(i)} = (x_1, x_2, \cdots, x_{i-1}, x_{i+1}, \cdots, x_n)
$$
for $i = 1, 2, \cdots, n$. The $i$th jackknife replication $\hat{\theta}_{(i)}$ of the statistic $\hat{\theta} = s(\mathbf{x})$ is
$$
\hat{\theta}_{(i)} = s(\mathbf{x}_{(i)}), \forall i = 1, 2, \cdots, n.
$$
Thus, for $\hat{\theta} = \bar{x}$, we have
$$
\begin{equation} \nonumber
\begin{aligned}
s(\mathbf{x}_{(i)}) &amp;amp;= \bar{x}_{(i)} \\&lt;br /&gt;
                    &amp;amp;= \frac{1}{n-1}\sum_{j \ne i}{x_j} \\&lt;br /&gt;
                    &amp;amp;= \frac{n\bar{x} - x_i}{n-1}
\end{aligned}
\end{equation}
$$&lt;/p&gt;

&lt;p&gt;The jackknife estimate of standard error is defined by
$$
\hat{se}_{jack} = [\frac{n-1}{n}\sum_{i=1}^n{(\hat{\theta}_{(i)} - \hat{\theta}_{(\cdot)})^2}]^{&amp;frac12;}
$$
where $\hat{\theta}_{(\cdot)} = \frac{1}{n}\sum_{i=1}^n{\hat{\theta}_{(i)}}$.&lt;/p&gt;

&lt;p&gt;The exact form of the factor $(n-1)/n$ in the above formula is derived by considering the special case $\hat{\theta} = \bar{x}$. For $\hat{\theta} = \bar{x}$, it is easy to show that
$$
\begin{equation} \nonumber
\begin{aligned}
\bar{x}_{(\cdot)} &amp;amp;= \frac{1}{n}\sum_{i=1}^n{\bar{x}_{(i)}} \\&lt;br /&gt;
                  &amp;amp;= \frac{1}{n}\sum_{i=1}^n{\frac{n\bar{x} - x_i}{n-1}} \\&lt;br /&gt;
                  &amp;amp;= \frac{n}{n-1}\bar{x} - \frac{1}{n-1}\frac{1}{n}\sum_{i=1}^n{x_i} \\&lt;br /&gt;
                  &amp;amp;= \frac{n}{n-1}\bar{x} - \frac{1}{n-1}\bar{x} \\&lt;br /&gt;
                  &amp;amp;= \bar{x}
\end{aligned}
\end{equation}
$$
Therefore,
$$
\begin{equation} \nonumber
\begin{aligned}
\hat{se}_{jack} &amp;amp;= [\frac{n-1}{n}\sum_{i=1}^n{(\hat{\theta}_{(i)} - \hat{\theta}_{(\cdot)})^2}]^{&amp;frac12;} \\&lt;br /&gt;
                &amp;amp;= [\frac{n-1}{n}\sum_{i=1}^n{(\bar{x}_{(i)} - \bar{x}_{(\cdot)})^2}]^{&amp;frac12;} \\&lt;br /&gt;
                &amp;amp;= [\frac{n-1}{n}\sum_{i=1}^n{(\frac{n\bar{x} - x_i}{n-1} - \bar{x})^2}]^{&amp;frac12;} \\&lt;br /&gt;
                &amp;amp;= [\frac{1}{n(n-1)}\sum_{i=1}^n{(x_i - \bar{x})^2}]^{&amp;frac12;} \\&lt;br /&gt;
                &amp;amp;= \frac{[\frac{1}{n-1}\sum_{i=1}^n{(x_i - \bar{x})^2}]^{&amp;frac12;}}{\sqrt{n}} \\&lt;br /&gt;
                &amp;amp;= \frac{\hat{\sigma}}{\sqrt{n}} \\&lt;br /&gt;
                &amp;amp;= \hat{se}(\bar{x})
\end{aligned}
\end{equation}
$$
where $\hat{se}(\bar{x})$ is the unbiased estimate of the standard error of the sample mean, and $\hat{\sigma}$ is unbiased estimate of the standard deviation of the population.&lt;/p&gt;

&lt;p&gt;The derivation suggests that the factor $(n-1)/n$ os exactly what is needed to make $\hat{se}_{jack}$ equal to the unbiased estimate of the standard error of the sample mean $\hat{se}(\bar{x})$. It is a somewhat arbitrary convention that $\hat{se}_{jack}$ uses the factor $(n-1)/n$, as in fact, the factor $(n-1)/n$ is derived by considering the special case $\hat{\theta} = \bar{x}$.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Stratified Importance Sampling</title>
      <link>http://blog.tonytsai.name/blog/2015-04-20-stratified-importance-sampling/</link>
      <pubDate>Mon, 20 Apr 2015 23:44:46 -0400</pubDate>
      
      <guid>http://blog.tonytsai.name/blog/2015-04-20-stratified-importance-sampling/</guid>
      <description>&lt;p&gt;The following &lt;code&gt;R&lt;/code&gt; codes implement the &lt;strong&gt;Example 5.13&lt;/strong&gt; in &lt;a href=&#34;http://www.amazon.com/Statistical-Computing-Chapman-Hall-Series/dp/1584885459&#34; target=&#34;_blank&#34;&gt;Statistical Computing with R&lt;/a&gt;, and compare the estimate $\hat{\theta}$ and $\hat{\sigma}$ from stratified importance sampling to the results from importance sampling. The example illustrates that stratification can reduce the varinace of importance sampling estimator.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;M &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;100000&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# number of replicates&lt;/span&gt;
g &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;x&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color: #719e07&#34;&gt;exp&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;log&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; x&lt;span style=&#34;color: #719e07&#34;&gt;^&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;x &lt;span style=&#34;color: #719e07&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;x &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;

&lt;span style=&#34;color: #586E75&#34;&gt;# importance sampling&lt;/span&gt;
u &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; runif&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;M&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# f3, inverse transform method&lt;/span&gt;
x &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-log&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; u &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;exp&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;-1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)))&lt;/span&gt;
fg &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; g&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;x&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;exp&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt;x&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;exp&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;-1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)))&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;theta.hat0 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;mean&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;fg&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 0.5253551
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;se0 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; sd&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;fg&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 0.09655589
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #586E75&#34;&gt;# stratified importance sampling&lt;/span&gt;
k &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;5&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# number of strata&lt;/span&gt;
m &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; M &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; k  &lt;span style=&#34;color: #586E75&#34;&gt;# replicates per stratum&lt;/span&gt;
theta.hat &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; se &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;numeric&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;k&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;

&lt;span style=&#34;color: #268BD2&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;j &lt;span style=&#34;color: #268BD2&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt;k&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  u &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; runif&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;m&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;j &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; k&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; j &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; k&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
  x &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-log&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; u &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;exp&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;-1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)))&lt;/span&gt;
  fg &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; g&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;x&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;k &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;exp&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt;x&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;exp&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;-1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)))&lt;/span&gt;
  theta.hat&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;j&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;mean&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;fg&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
  se&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;j&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; sd&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;fg&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;span style=&#34;color: #719e07&#34;&gt;sum&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;theta.hat&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 0.5248449
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;sum&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;se&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 0.01832981
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The estimate $\hat{\theta}$ is close, while the estimated standard error $\hat{\sigma}$ is reduced from 0.0965559 to 0.0183298 with stratification.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>SIRS Model with Time Dependent Transmission Rate</title>
      <link>http://blog.tonytsai.name/blog/2014-12-04-sirs-model-with-time-dependent-transmission-rate/</link>
      <pubDate>Thu, 04 Dec 2014 23:44:46 -0400</pubDate>
      
      <guid>http://blog.tonytsai.name/blog/2014-12-04-sirs-model-with-time-dependent-transmission-rate/</guid>
      <description>

&lt;h2 id=&#34;1-sirs-model&#34;&gt;1 SIRS Model&lt;/h2&gt;

&lt;p&gt;The &lt;a href=&#34;http://en.wikipedia.org/wiki/Epidemic_model#The_SIRS_model&#34; target=&#34;_blank&#34;&gt;SIRS model&lt;/a&gt; is simply an extension of the &lt;a href=&#34;http://en.wikipedia.org/wiki/Epidemic_model#The_SIR_model&#34; target=&#34;_blank&#34;&gt;SIR model&lt;/a&gt; as it allows members of the recovered class to rejoin the susceptible class at a defined rate, which integrates the impact of waning immunity following antigenic drift. Similar to the SIR model, a fixed population without births and deaths is considered in the SIRS model. The standard form of SIRS model is described as
$$
\begin{equation}
\begin{aligned}
  &amp;amp; \frac{dS}{dt} = fR - \frac{\beta SI}{N} \\&lt;br /&gt;
  &amp;amp; \frac{dI}{dt} = \frac{\beta SI}{N} - \gamma I \\&lt;br /&gt;
  &amp;amp; \frac{dR}{dt} = \gamma I - fR
\end{aligned}
\label{eq1}
\end{equation}
$$
where $f$ is the average loss of immunity rate of recovered indiviuals, and the other notations are the same as the SIR model. Note that SIR model is a special case  of SIRS model under condition of $f = 0$. Hence, it is possible to create a general function to solve both SIR and SIRS models.&lt;/p&gt;

&lt;p&gt;As only two of the three ODEs are independent, $R(t)$ does not have to be treated explicitly and using ODEs of $S(t)$ and $I(t)$ to describe the dynamic of SIRS model are adequate. Substitute $R(t) = N - S(t) - I(t)$ into ODE of $S(t)$ and the formula is simplified as follows
$$
\begin{equation}
\begin{aligned}
  &amp;amp; \frac{dS}{dt} = f(N - S - I) - \frac{\beta SI}{N} \\&lt;br /&gt;
  &amp;amp; \frac{dI}{dt} = \frac{\beta SI}{N} - \gamma I
\end{aligned}
\label{eq2}
\end{equation}
$$&lt;/p&gt;

&lt;p&gt;The form of SIRS model described in &lt;a href=&#34;http://www.pnas.org/content/101/48/16915.abstract&#34; target=&#34;_blank&#34;&gt;Dushoff et al. (2004)&lt;/a&gt; and &lt;a href=&#34;http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1000316&#34; target=&#34;_blank&#34;&gt;Shaman et al. (2010)&lt;/a&gt; is as follows
$$
\begin{equation}
\begin{aligned} \label{eq3}
  &amp;amp; \frac{dS}{dt} = \frac{N - S - I}{L} - \frac{\beta SI}{N} \\&lt;br /&gt;
  &amp;amp; \frac{dI}{dt} = \frac{\beta SI}{N} - \frac{I}{D}
\end{aligned}
\end{equation}
$$
where $L$ is the average duration of immunity of recoverd indiviuals, and $D$ is the mean infectious period of infected indiviuals. Comparing with ODEs $(\ref{eq2})$, $L = \frac{1}{f}$ and $D = \frac{1}{\gamma}$ are derived.&lt;/p&gt;

&lt;p&gt;In the following subsections, &lt;strong&gt;RK4&lt;/strong&gt; method is applied to solve SIRS model in different forms.&lt;/p&gt;

&lt;h3 id=&#34;1-1-rk4sirs-std-function&#34;&gt;1.1 &lt;code&gt;RK4SIRS.std&lt;/code&gt; function&lt;/h3&gt;

&lt;p&gt;The iterative formula of &lt;strong&gt;RK4&lt;/strong&gt; method for solving SIRS model in the standard form $(\ref{eq1})$ can be easily derived and won&amp;rsquo;t be presented here. The following codes firstly define four helper functions. Three of them describe $S(t)$, $I(t)$ and $R(t)$ compartments of SIRS model. The other one defines the &lt;strong&gt;infection rate&lt;/strong&gt; (see Table 1 in &lt;a href=&#34;http://www.pnas.org/content/101/48/16915.abstract&#34; target=&#34;_blank&#34;&gt;Dushoff et al. (2004)&lt;/a&gt;) to calculate cummulative incidence. Different from SIR model, the infection rate is only the second term of $S(t)$ compartment in SIRS model. Therefore, an additional helper function is needed to separately define the infection rate.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #586E75&#34;&gt;# define S, I, R compartments of SIRS model&lt;/span&gt;
dSdt.std &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;f &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; R &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; beta &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; N&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;

dIdt.std &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;beta &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; N &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; gamma &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;

dRdt.std &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;gamma &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; f &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;

&lt;span style=&#34;color: #586E75&#34;&gt;# define infection rate&lt;/span&gt;
dCIdt.std &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;beta &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; N&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The iterative algorithm for calculating cummumcaltive incidence resembles those of $S(t)$, $I(t)$ and $R(t)$. The implementation of &lt;strong&gt;RK4&lt;/strong&gt; method for SIRS model is presented as follows.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #586E75&#34;&gt;# RK4 method for the numerical integration of SIRS model in standard form&lt;/span&gt;
RK4SIRS.std &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; f&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R0 &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; incidence &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;FALSE&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  N &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;&amp;lt;-&lt;/span&gt; S0 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; I0 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; R0
  
  S &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  I &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  R &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;R0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  CI &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# cummulative incidence&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #268BD2&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    Si &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    Ii &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    Ri &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    CIi &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; CI&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    
    S.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ri&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    R.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dRdt.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ri&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    CI.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dCIdt.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    
    S.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ri &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; R.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    R.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dRdt.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ri &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; R.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    CI.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dCIdt.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    
    S.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ri &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; R.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    R.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dRdt.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ri &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; R.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    CI.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dCIdt.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    
    S.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ri &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; R.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    R.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dRdt.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ri &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; R.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    CI.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dCIdt.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    
    S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; S.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; I.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    R&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ri &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;R.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; R.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; R.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; R.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    CI&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; CIi &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;CI.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; CI.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; CI.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; CI.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;!&lt;/span&gt;incidence&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;data.frame&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color: #586E75&#34;&gt;# newly infected per day (incidence)&lt;/span&gt;
    inc &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;diff&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;CI&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
    &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;data.frame&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; inc &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; inc&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; cum.inc &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; CI&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&#34;1-2-rk4sirs-function&#34;&gt;1.2 &lt;code&gt;RK4SIRS&lt;/code&gt; function&lt;/h3&gt;

&lt;p&gt;There are many repetitive computations in the implementation of &lt;code&gt;RK4SIRS.std&lt;/code&gt; function, especially for calculating cummulative incidence. Actually, the system of ODEs of SIRS model describes the transition of an individual between susceptible, infectious, and recovered states. For SIRS model in simplified form $(\ref{eq2})$, only susceptible and infectious states are necessary to represent the system state and the system state at time $t$ is usually expressed as state vector $\mathbf{Z}(t)\equiv (S(t), I(t))$. As presented in Table 1, infection, recovery, and immunity loss events can change the system state at a rate of $\frac{\beta SI}{N}$, $\gamma I$, and $f(N-S-I)$, respectively.&lt;/p&gt;

&lt;p&gt;Table 1:  Markov chain transition rate (source: &lt;a href=&#34;http://www.pnas.org/content/101/48/16915.abstract&#34; target=&#34;_blank&#34;&gt;Dushoff et al. (2004)&lt;/a&gt;) &lt;!-- how to generate table caption, which is supported in pandoc --&gt;&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Event&lt;/th&gt;
&lt;th&gt;Change&lt;/th&gt;
&lt;th&gt;Rate&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Infection&lt;/td&gt;
&lt;td&gt;$(S,I)\rightarrow (S-1,I+1)$&lt;/td&gt;
&lt;td&gt;$\frac{\beta SI}{N}$&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Recovery&lt;/td&gt;
&lt;td&gt;$(S,I)\rightarrow (S, I-1)$&lt;/td&gt;
&lt;td&gt;$\gamma I$&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Immunity loss&lt;/td&gt;
&lt;td&gt;$(S,I)\rightarrow (S+1, I)$&lt;/td&gt;
&lt;td&gt;$f(N-S-I)$&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Instead of directly defining $S(t)$ and $I(t)$ compartments of SIRS model, using helper functions to define the events can avoid redundant computing as events describe the changes in system state at fine-grained scale. According to Table 1, &lt;strong&gt;RK4&lt;/strong&gt; method for solving SIRS model in simplified form $(\ref{eq2})$ can be easily implemented by slightly modified from &lt;code&gt;RK4SIRS.std&lt;/code&gt; function.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #586E75&#34;&gt;# define infection rate&lt;/span&gt;
inf.rate &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;beta &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; N&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;

&lt;span style=&#34;color: #586E75&#34;&gt;# define recovery rate&lt;/span&gt;
rec.rate &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;gamma &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;

&lt;span style=&#34;color: #586E75&#34;&gt;# define immunity loss rate&lt;/span&gt;
ilos.rate &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;f &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;N &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;

&lt;span style=&#34;color: #586E75&#34;&gt;# RK4 method for numerical integration of SIRS model in simplified form&lt;/span&gt;
RK4SIRS &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; f&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R0 &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; incidence &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;FALSE&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  N &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;&amp;lt;-&lt;/span&gt; S0 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; I0 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; R0
  
  S &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  I &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  R &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;R0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  CI &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# cummulative incidence&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #268BD2&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    Si &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    Ii &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    Ri &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    CIi &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; CI&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    
    Einf &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; inf.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# event of infection&lt;/span&gt;
    Erec &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; rec.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# event of recovery&lt;/span&gt;
    Eilos &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; ilos.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# event of immunity loss&lt;/span&gt;
    S.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Eilos &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Einf
    I.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Einf &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Erec
    CI.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Einf
    
    Einf &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; inf.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    Erec &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; rec.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    Eilos &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; ilos.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    S.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Eilos &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Einf
    I.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Einf &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Erec
    CI.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Einf
    
    Einf &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; inf.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    Erec &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; rec.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    Eilos &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; ilos.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    S.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Eilos &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Einf
    I.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Einf &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Erec
    CI.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Einf
    
    Einf &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; inf.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    Erec &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; rec.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    Eilos &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; ilos.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    S.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Eilos &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Einf
    I.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Einf &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Erec
    CI.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Einf
    
    S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; S.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; I.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    CI&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; CIi &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;CI.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; CI.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; CI.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; CI.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
  R &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; N &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;
  
  &lt;span style=&#34;color: #268BD2&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;!&lt;/span&gt;incidence&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;data.frame&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color: #586E75&#34;&gt;# newly infected per day (incidence)&lt;/span&gt;
    inc &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;diff&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;CI&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
    &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;data.frame&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; inc &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; inc&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; cum.inc &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; CI&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&#34;1-3-rk4-function&#34;&gt;1.3 &lt;code&gt;rk4&lt;/code&gt; function&lt;/h3&gt;

&lt;p&gt;Using &lt;code&gt;rk4&lt;/code&gt; function from &lt;code&gt;deSolve&lt;/code&gt; package to solve SIRS model only needs to redefine the model and the vector of parameters used in SIRS model.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #586E75&#34;&gt;# vector of parameters used in SIRS model&lt;/span&gt;
params &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;beta &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; gamma &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; f &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; f&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;# definition of SIRS model&lt;/span&gt;
SIRS &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; y&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; params&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color: #719e07&#34;&gt;with&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;as.list&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;params&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; y&lt;span style=&#34;color: #93A1A1&#34;&gt;)),&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    dS &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; f &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; R &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; beta &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; N
    dI &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; beta &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; N &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; gamma &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;
    dR &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; gamma &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; f &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; R
    &lt;span style=&#34;color: #DC322F&#34;&gt;list&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;dS&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; dI&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; dR&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;})&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The above three functions are tested with the same study case of the spread of Hong Kong flu in New York city and they all give the same results. Note that the parameter $f = \frac{1}{L} = \frac{1}{3.86 \times 365}$ comes from the parameters combination for generation of synthetic truth in &lt;a href=&#34;http://www.pnas.org/content/109/50/20425.abstract&#34; target=&#34;_blank&#34;&gt;Shaman and Karspeck (2012)&lt;/a&gt;. Here, only results given by &lt;code&gt;RK4SIRS&lt;/code&gt; function are presented to avoid redundancy.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://tonytsai.name/materials/SIRS_files/figure-html/unnamed-chunk-5-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #586E75&#34;&gt;# peak of the infected&lt;/span&gt;
&lt;span style=&#34;color: #719e07&#34;&gt;which.max&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #719e07&#34;&gt;$I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 75
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;max&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #719e07&#34;&gt;$I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 499451.1
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #586E75&#34;&gt;# peak of incidence&lt;/span&gt;
&lt;span style=&#34;color: #719e07&#34;&gt;which.max&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;inc&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 73
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;max&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;inc&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 174175.2
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;1-4-benchmark&#34;&gt;1.4 Benchmark&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;RK4SIRS.std&lt;/code&gt;, &lt;code&gt;RK4SIRS&lt;/code&gt; and &lt;code&gt;rk4&lt;/code&gt; are separately runned 1000 times for benchmark performance analysis.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;compare &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; microbenchmark&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;rk4&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;y0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; times&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; SIRS&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; params&lt;span style=&#34;color: #93A1A1&#34;&gt;),&lt;/span&gt; 
                          RK4SIRS&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; f&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; incidence &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;TRUE&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;),&lt;/span&gt; 
                          RK4SIRS.std&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; f&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; incidence &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;TRUE&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;),&lt;/span&gt; 
                          times &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;compare
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## Unit: milliseconds
##         expr       min        lq      mean    median        uq       max
##          rk4 27.804584 29.519107 30.347914 30.938286 31.275767 32.472944
##      RK4SIRS  6.015463  6.542592  7.377228  7.411822  8.341024  8.769777
##  RK4SIRS.std  8.610047  9.109195  9.961587  9.599131 10.197847 12.959678
##  neval
##     10
##     10
##     10
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://tonytsai.name/materials/SIRS_files/figure-html/unnamed-chunk-11-1.png&#34; alt=&#34;&#34; /&gt;
As shown in the above figure, &lt;code&gt;RK4SIRS&lt;/code&gt; function runs the fastest. Subsequently, SIRS model will be solved in simplified form \eqref{eq:2}.&lt;/p&gt;

&lt;h3 id=&#34;1-5-basic-reproductive-number-r-0&#34;&gt;1.5 Basic Reproductive Number $R_0$&lt;/h3&gt;

&lt;p&gt;Technically, the &lt;a href=&#34;http://en.wikipedia.org/wiki/Basic_reproduction_number&#34; target=&#34;_blank&#34;&gt;basic reproductive number&lt;/a&gt; $R_0$ is defined as the number of secondary infections caused by a single infective introduced into a population made up entirely of susceptible individuals over the course of the infection of this single infective. For the susceptible population ($S_0 \approx N$), this infective individual makes $\beta$ contacts per unit time producing new infections with a mean infectious period of $D$. Therefore, the basic reproduction number is
$$
\begin{equation} \label{eq4}
  R_0 = \beta D = \frac{\beta}{\gamma}
\end{equation}
$$&lt;/p&gt;

&lt;p&gt;Actually, the basic reproductive number is often compared to &lt;strong&gt;1&lt;/strong&gt; to determine whether an epidemic occurs or the disease simply dies out.&lt;/p&gt;

&lt;h2 id=&#34;2-time-dependent-transmission-rate-beta-t&#34;&gt;2 Time Dependent Transmission Rate $\beta(t)$&lt;/h2&gt;

&lt;p&gt;Equation $(6)$ in &lt;strong&gt;Effects of Absolute Humidity on Influenza Virus&lt;/strong&gt; shows the relationship between basic reproductive number $R_0(t)$ and specific humidity $q(t)$ at time $t$. Combining with equation $(\ref{eq4})$, it&amp;rsquo;s easy to deduce that transmission rate $\beta$ is also modulated by specific humidity $q$ and time dependent. Hence, replacing the constant $\beta$ in ODEs $(\ref{eq2})$ with time dependent $\beta (t)$ can make SIRS model more reasonable. The resulting SIRS model with time dependent transmission rate $\beta (t)$ is expressed as follow
$$
\begin{equation}
\begin{aligned} \label{eq:5}
  &amp;amp; \frac{dS}{dt} = f(N - S - I) - \frac{\beta (t) SI}{N} &lt;br /&gt;
  &amp;amp; \frac{dI}{dt} = \frac{\beta (t) SI}{N} - \gamma I
\end{aligned}
\end{equation}
$$&lt;/p&gt;

&lt;h3 id=&#34;2-1-implementation&#34;&gt;2.1 Implementation&lt;/h3&gt;

&lt;p&gt;The &lt;strong&gt;RK4&lt;/strong&gt; method for numerical integration of SIRS model with time dependent transmission rate $\beta(t)$ can be easily implemented by adding parameters to helper event functions.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #586E75&#34;&gt;# define infection rate&lt;/span&gt;
inf.rate &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;beta &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; N&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;

&lt;span style=&#34;color: #586E75&#34;&gt;# define recovery rate&lt;/span&gt;
rec.rate &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;gamma &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;

&lt;span style=&#34;color: #586E75&#34;&gt;# define immunity loss rate&lt;/span&gt;
ilos.rate &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; f&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;f &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;N &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;

&lt;span style=&#34;color: #586E75&#34;&gt;# beta is a numeric vector of length n or 1&lt;/span&gt;
RK4SIRS &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; f&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R0 &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; incidence &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;FALSE&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  N &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;&amp;lt;-&lt;/span&gt; S0 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; I0 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; R0
  
  S &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  I &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  R &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;R0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  CI &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# cummulative incidence&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #268BD2&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    bti &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    Si &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    Ii &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    CIi &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; CI&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    
    Einf &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; inf.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; bti&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# event of infection&lt;/span&gt;
    Erec &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; rec.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# event of recovery&lt;/span&gt;
    Eilos &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; ilos.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; f&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# event of immunity loss&lt;/span&gt;
    S.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Eilos &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Einf
    I.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Einf &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Erec
    CI.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Einf
    
    Einf &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; inf.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; bti&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    Erec &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; rec.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    Eilos &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; ilos.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; f&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    S.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Eilos &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Einf
    I.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Einf &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Erec
    CI.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Einf
    
    Einf &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; inf.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; bti&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    Erec &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; rec.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    Eilos &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; ilos.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; f&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    S.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Eilos &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Einf
    I.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Einf &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Erec
    CI.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Einf
    
    Einf &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; inf.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; bti&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    Erec &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; rec.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    Eilos &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; ilos.rate&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; f&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    S.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Eilos &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Einf
    I.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Einf &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Erec
    CI.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Einf
    
    S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; S.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; I.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    CI&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; CIi &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;CI.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; CI.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; CI.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; CI.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
  R &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; N &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;
  
  &lt;span style=&#34;color: #268BD2&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;!&lt;/span&gt;incidence&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;data.frame&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color: #586E75&#34;&gt;# newly infected per day (incidence)&lt;/span&gt;
    inc &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;diff&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;CI&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
    &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;data.frame&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; inc &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; inc&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; cum.inc &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; CI&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&#34;2-2-simulation&#34;&gt;2.2 Simulation&lt;/h3&gt;

&lt;p&gt;The following simulation example is adapted from &lt;em&gt;Fig. 1a&lt;/em&gt; in &lt;a href=&#34;http://www.pnas.org/content/101/48/16915.abstract&#34; target=&#34;_blank&#34;&gt;Dushoff et al. (2004)&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;S0 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;500000&lt;/span&gt;
I0 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;100&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# I0 has little effect on the dynamic equilibrium&lt;/span&gt;
R0 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;
N &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; S0 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; I0 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; R0
L &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;4&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# yr&lt;/span&gt;
f &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; L
D &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0.02&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# yr&lt;/span&gt;
gamma &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; D
dt &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0.01&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# yr&lt;/span&gt;
t &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;seq&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;from &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; to &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;20&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; by &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
beta0 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;500&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# persons per yr&lt;/span&gt;
beta1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0.04&lt;/span&gt;
beta &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; beta0 &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; beta1 &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;cos&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;pi&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
n &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;length&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;-1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;])&lt;/span&gt;

r &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; RK4SIRS&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; f &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; f&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; incidence &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;TRUE&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
r &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;cbind&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; r&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;# plot S, I, R curves&lt;/span&gt;
&lt;span style=&#34;color: #719e07&#34;&gt;library&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;reshape2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
r.plot &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; id &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;t&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; measure &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;S&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;I&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;inc&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;cum.inc&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;# change levels for display&lt;/span&gt;
&lt;span style=&#34;color: #719e07&#34;&gt;levels&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r.plot&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;variable&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Susceptible&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Infected&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Recovered&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Incidence&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; 
                             &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Cummulative incidence&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #719e07&#34;&gt;library&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;ggplot2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
p &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r.plot&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; aes&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;x &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; y &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; value&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; group &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; color &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
p &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; geom_line&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  xlab&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Time (years)&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  facet_wrap&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;~&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; scales &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;free&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  ggtitle&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Simulation&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  theme_bw&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;base_size &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;12&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  theme&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;legend.position &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;none&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&#34;http://tonytsai.name/materials/SIRS_files/figure-html/unnamed-chunk-13-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;In &lt;em&gt;Fig. 1a&lt;/em&gt; simulation, the basic reproductive number $R_0=D\beta_0=$ 10, and the intrinsic period of oscillation $T=2\pi \sqrt{\frac{DL}{R_0-1}}=$ 0.59. As shown in above figures, after starting simulation for several years, the compartments of SIRS model (including &lt;strong&gt;incidence&lt;/strong&gt;) are in dynamic equilibrium. To show the details of deterministic equilibrium, the following codes only plot the subset results of 10 ~ 20 years.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;r.eqb &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; r&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;r&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;t &lt;span style=&#34;color: #719e07&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
r.plot &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r.eqb&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; id &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;t&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; measure &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;S&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;I&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;inc&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;cum.inc&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
&lt;span style=&#34;color: #719e07&#34;&gt;levels&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r.plot&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;variable&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Susceptible&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Infected&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Recovered&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Incidence&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; 
                             &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Cummulative incidence&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
p &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r.plot&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; aes&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;x &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; y &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; value&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; group &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; color &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
p &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; geom_line&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  scale_x_continuous&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;breaks &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;10&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;20&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; labels &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;10&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;20&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; expand &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  xlab&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Time (years)&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  facet_wrap&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;~&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; scales &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;free&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; ncol &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  ggtitle&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Subset Results of Equilibrium&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  theme_bw&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;base_size &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;14&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  theme&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;legend.position &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;none&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&#34;http://tonytsai.name/materials/SIRS_files/figure-html/unnamed-chunk-14-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The &lt;em&gt;Fig. 1b&lt;/em&gt; simulation is very similar to the one of Fig. 1a, but with different parameters of $L=8$ yr, $D=0.025$ yr, and $\beta_0=400$ persons per yr. The resulting plots of simulation are presented.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;L &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;8&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# yr&lt;/span&gt;
D &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0.025&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# yr&lt;/span&gt;
beta0 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;400&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# persons per yr&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&#34;http://tonytsai.name/materials/SIRS_files/figure-html/unnamed-chunk-16-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://tonytsai.name/materials/SIRS_files/figure-html/unnamed-chunk-17-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;In &lt;em&gt;Fig. 1b&lt;/em&gt; simulation, the basic reproductive number $R_0=$ 10, and the intrinsic period of oscillation $T=$ 0.94. From the &lt;code&gt;Infected&lt;/code&gt; panel of &lt;code&gt;Subset Results of Equilibrium&lt;/code&gt; figure, strong oscillations (noticing the y-axis range) due to &lt;strong&gt;resonance&lt;/strong&gt; are observed. This is because comparing with &lt;em&gt;Fig. 1a&lt;/em&gt; simulation, while the basic reprodutive number $R_0$ keeps the same, the period of endogenous SIRS oscillation $T$ is much more near the period of seasonal forcing (&lt;strong&gt;1&lt;/strong&gt; year) (see &lt;a href=&#34;http://www.pnas.org/content/101/48/16915.abstract&#34; target=&#34;_blank&#34;&gt;Dushoff et al. (2004)&lt;/a&gt; for further details).&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Gains from Paper Reading</title>
      <link>http://blog.tonytsai.name/blog/2014-12-03-gains-from-paper-reading/</link>
      <pubDate>Wed, 03 Dec 2014 23:44:46 -0400</pubDate>
      
      <guid>http://blog.tonytsai.name/blog/2014-12-03-gains-from-paper-reading/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://www.pnas.org/content/106/9/3243&#34; target=&#34;_blank&#34;&gt;Shaman.Kohn-PNAS-2009&lt;/a&gt;too young too simple&lt;/p&gt;

&lt;p&gt;PNAS&lt;strong&gt;Jeffrey Shaman&lt;/strong&gt;Google6&lt;/p&gt;

&lt;p&gt;Shamanreproducible researchopen access&lt;/p&gt;

&lt;p&gt;&lt;br&gt;
PS:POST title&lt;code&gt;:&lt;/code&gt;CSS&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Precision Difference of ode45 between R and MATLAB</title>
      <link>http://blog.tonytsai.name/blog/2014-11-24-precision-difference-of-ode45-between-r-and-matlab/</link>
      <pubDate>Mon, 24 Nov 2014 23:44:46 -0400</pubDate>
      
      <guid>http://blog.tonytsai.name/blog/2014-11-24-precision-difference-of-ode45-between-r-and-matlab/</guid>
      <description>&lt;p&gt;&lt;code&gt;ode45&lt;/code&gt; solvers from both &lt;code&gt;R&lt;/code&gt; and &lt;code&gt;MATLAB&lt;/code&gt; are used to run simulations of the &lt;a href=&#34;https://www.math.duke.edu//education/ccp/materials/diffcalc/sir/sir1.html&#34; target=&#34;_blank&#34;&gt;spread of Hong Kong flu in New York city&lt;/a&gt; with different initial susceptible individuals $S_0 =$ 790, 7900, 79000, 790000, and 7900000. The maximum infected people $I_{max}$ under each condition is recorded for comparison. The following codes draw a figure showing the precision difference of &lt;code&gt;ode45&lt;/code&gt; solvers between &lt;code&gt;R&lt;/code&gt; and &lt;code&gt;MATLAB&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;Imax &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;data.frame&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S0 &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;79&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;10&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;^&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;),&lt;/span&gt; 
                   R &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;57.12598&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;504.9923&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;4984.303&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;49749.60&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;497474.2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;),&lt;/span&gt; 
                   MATLAB &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;57.14987&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;505.3385&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;4987.447&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;49774.26&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;497552.2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
Imax&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color: #586E75&#34;&gt;`MATLAB - R`&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Imax&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;MATLAB &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Imax&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;R
&lt;span style=&#34;color: #586E75&#34;&gt;# plot delta Imax VS. S0&lt;/span&gt;
Imax.plot &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;Imax&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; id &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;S0&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; measure &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;MATLAB&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;MATLAB - R&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
&lt;span style=&#34;color: #719e07&#34;&gt;library&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;scales&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
p &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;Imax.plot&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; aes&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;x &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; y &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; value&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; group &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; color &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
p &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; geom_line&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  geom_point&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  scale_x_log10&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;name &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;expression&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]),&lt;/span&gt; breaks &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;79&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;10&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;^&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;),&lt;/span&gt; labels &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; comma&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  scale_y_continuous&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;name &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Imax&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; labels &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; comma&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  facet_wrap&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;~&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; scales &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;free&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  ggtitle&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Precision Diffference of ode45 Solver between R and MATLAB&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  theme_bw&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;base_size &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;14&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&#34;http://tonytsai.name/materials/RK4SIR_files/figure-html/unnamed-chunk-21-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;As shown in the right panel, the difference of $I_{max}$ increases with the initial susceptible number $S_0$ getting larger. When $S_0 &amp;lt; 8,000$, the difference is no more than 1. When $S_0$ is very large, the absolute precision difference also becomes larger; however, the relative accuracy keeps and it is accepted in this case.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>RK4 Method for Solving SIR Model</title>
      <link>http://blog.tonytsai.name/blog/2014-11-24-rk4-method-for-solving-sir-model/</link>
      <pubDate>Mon, 24 Nov 2014 23:44:46 -0400</pubDate>
      
      <guid>http://blog.tonytsai.name/blog/2014-11-24-rk4-method-for-solving-sir-model/</guid>
      <description>

&lt;p&gt;My object is to rewrite the 4th order Runge-Kutta (abbreviated for &lt;strong&gt;RK4&lt;/strong&gt;) method for solving the absolute humidity-driven SIRS model developed by &lt;a href=&#34;http://www.ploscompbiol.org/article/info%3Adoi%2F10.1371%2Fjournal.pcbi.1003583&#34; target=&#34;_blank&#34;&gt;Yang et al. (2014)&lt;/a&gt; in &lt;code&gt;R&lt;/code&gt; language. The details of the SIRS model are provided in the paper.&lt;/p&gt;

&lt;h2 id=&#34;1-rk4&#34;&gt;1 RK4&lt;/h2&gt;

&lt;h3 id=&#34;1-1-preliminary&#34;&gt;1.1 Preliminary&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;RK4&lt;/strong&gt; is one of the classic methods for numerical integration of ODE models. A brief introduction of &lt;strong&gt;RK4&lt;/strong&gt; refers to &lt;a href=&#34;http://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods&#34; target=&#34;_blank&#34;&gt;Wikipedia&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Consider the following initial value problem of ODE
&lt;div&gt;
$$
\begin{equation}
\begin{aligned}
  &amp;amp; \frac{dy}{dt} = f(t, y) \\&lt;br /&gt;
  &amp;amp; y(t_0) = y_0
\end{aligned}
\label{eq1}
\end{equation}
$$
&lt;/div&gt;
where $y(t)$ is the unknown function (scalar or &lt;strong&gt;vector&lt;/strong&gt;) which I would like to approximate.&lt;/p&gt;

&lt;p&gt;The iterative formula of &lt;strong&gt;RK4&lt;/strong&gt; method for solving ODE $(\ref{eq1})$ is as follows
$$
\begin{equation}
\begin{aligned}
  &amp;amp; y_{n + 1} = y_n + \frac{\Delta t}{6}(k_1 + 2k_2 + 2k_3 + k_4) \\&lt;br /&gt;
  &amp;amp; k_1 = f(t_n, y_n) \\&lt;br /&gt;
  &amp;amp; k_2 = f(t_n + \frac{\Delta t}{2}, y_n + \frac{k_1\Delta t}{2}) \\&lt;br /&gt;
  &amp;amp; k_3 = f(t_n + \frac{\Delta t}{2}, y_n + \frac{k_2\Delta t}{2}) \\&lt;br /&gt;
  &amp;amp; k_4 = f(t_n + \Delta t, y_n + k_3\Delta t) \\&lt;br /&gt;
  &amp;amp; t_{n + 1} = t_n + \Delta t \\&lt;br /&gt;
  &amp;amp; n = 0, 1, 2, 3, \dots
\end{aligned}
\label{eq2}
\end{equation}
$$&lt;/p&gt;

&lt;p&gt;For simplicity, here I use the simplest &lt;a href=&#34;http://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology&#34; target=&#34;_blank&#34;&gt;SIR model&lt;/a&gt; rather than the SIRS model used in the paper to examine whether the &lt;strong&gt;RK4&lt;/strong&gt; method has been implemented correctly. The SIR model is defined as follows
$$
\begin{equation} \label{eq3}
\begin{aligned}
  &amp;amp; \frac{dS}{dt} = -\frac{\beta SI}{N} \\&lt;br /&gt;
  &amp;amp; \frac{dI}{dt} = \frac{\beta SI}{N} - \gamma I \\&lt;br /&gt;
  &amp;amp; \frac{dR}{dt} = \gamma I
\end{aligned}
\end{equation}
$$
where $S(t)$ is the number of susceptible people in the population at time $t$, $I(t)$ is the number of infectious people at time $t$, $R(t)$ is the number of recovered people at time $t$, $\beta$ is the transmission rate, $\gamma$ represents the recovery rate, and $N = S(t) + I(t) + R(t)$ is the fixed population.&lt;/p&gt;

&lt;p&gt;According to the general iterative formula $(\ref{eq2})$, the iterative formulas for $S(t)$, $I(t)$ and $R(t)$ of SIR model can be written out.
$$
\begin{equation}
\begin{aligned}
  &amp;amp; S_{n + 1} = S_n + \frac{\Delta t}{6}(k_1^S + 2k_2^S + 2k_3^S + k_4^S) \\&lt;br /&gt;
  &amp;amp; k_1^S = f(t_n, S_n, I_n) = -\frac{\beta S_nI_n}{N} \\&lt;br /&gt;
  &amp;amp; k_2^S = f(t_n + \frac{\Delta t}{2}, S_n + \frac{k_1^S\Delta t}{2}, I_n + \frac{k_1^I\Delta t}{2}) = -\frac{\beta}{N}(S_n + \frac{k_1^S\Delta t}{2})(I_n + \frac{k_1^I\Delta t}{2}) \\&lt;br /&gt;
  &amp;amp; k_3^S = f(t_n + \frac{\Delta t}{2}, S_n + \frac{k_2^S\Delta t}{2}, I_n + \frac{k_2^I\Delta t}{2}) = -\frac{\beta}{N}(S_n + \frac{k_2^S\Delta t}{2})(I_n + \frac{k_2^I\Delta t}{2}) \\&lt;br /&gt;
  &amp;amp; k_4^S = f(t_n + \Delta t, S_n + k_3^S\Delta t, I_n + k_3^I\Delta t) = -\frac{\beta}{N}(S_n + k_3^S\Delta t)(I_n + k_3^I\Delta t)
\end{aligned}
\end{equation}
$$&lt;/p&gt;

&lt;p&gt;$$
\begin{equation}
\begin{aligned}
  &amp;amp; I_{n + 1} = I_n + \frac{\Delta t}{6}(k_1^I + 2k_2^I + 2k_3^I + k_4^I) \\&lt;br /&gt;
  &amp;amp; k_1^I = f(t_n, S_n, I_n) = \frac{\beta S_nI_n}{N} - \gamma I_n \\&lt;br /&gt;
  &amp;amp; k_2^I = f(t_n + \frac{\Delta t}{2}, S_n + \frac{k_1^S\Delta t}{2}, I_n + \frac{k_1^I\Delta t}{2}) = \frac{\beta}{N}(S_n + \frac{k_1^S\Delta t}{2})(I_n + \frac{k_1^I\Delta t}{2}) - \gamma (I_n + \frac{k_1^I\Delta t}{2}) \\&lt;br /&gt;
  &amp;amp; k_3^I = f(t_n + \frac{\Delta t}{2}, S_n + \frac{k_2^S\Delta t}{2}, I_n + \frac{k_2^I\Delta t}{2}) = \frac{\beta}{N}(S_n + \frac{k_2^S\Delta t}{2})(I_n + \frac{k_2^I\Delta t}{2}) - \gamma (I_n + \frac{k_2^I\Delta t}{2}) \\&lt;br /&gt;
  &amp;amp; k_4^I = f(t_n + \Delta t, S_n + k_3^S\Delta t, I_n + k_3^I\Delta t) = \frac{\beta}{N}(S_n + k_3^S\Delta t)(I_n + k_3^I\Delta t) - \gamma (I_n + k_3^I\Delta t)
\end{aligned}
\end{equation}
$$&lt;/p&gt;

&lt;p&gt;$$
\begin{equation}
\begin{aligned}
  &amp;amp; R_{n + 1} = R_n + \frac{\Delta t}{6}(k_1^R + 2k_2^R + 2k_3^R + k_4^R) \\&lt;br /&gt;
  &amp;amp; k_1^R = f(t_n, I_n) = \gamma I_n \\&lt;br /&gt;
  &amp;amp; k_2^R = f(t_n + \frac{\Delta t}{2}, I_n + \frac{k_1^I\Delta t}{2}) = \gamma (I_n + \frac{k_1^I\Delta t}{2}) \\&lt;br /&gt;
  &amp;amp; k_3^R = f(t_n + \frac{\Delta t}{2}, I_n + \frac{k_2^I\Delta t}{2}) = \gamma (I_n + \frac{k_2^I\Delta t}{2}) \\&lt;br /&gt;
  &amp;amp; k_4^R = f(t_n + \Delta t, I_n + k_3^I\Delta t) = \gamma (I_n + k_3^I\Delta t)
\end{aligned}
\end{equation}
$$&lt;/p&gt;

&lt;p&gt;Note that since the population $N = S(t) + I(t) + R(t)$ is constant, there will have $\frac{dS}{dt} + \frac{dI}{dt} + \frac{dR}{dt} = 0$. Therefore, only two of the three ODEs are independent and sufficient to solve the ODEs. Here, only iterative formulas for $S(t)$ and $I(t)$ are used and $R(t)$ is calculated by $R(t) = N - S(t) - I(t)$.&lt;/p&gt;

&lt;p&gt;The specific simulation parameters for SIR model are from the study case of &lt;a href=&#34;https://www.math.duke.edu//education/ccp/materials/diffcalc/sir/sir1.html&#34; target=&#34;_blank&#34;&gt;spread of Hong Kong flu in New York city&lt;/a&gt;. The inital values for the population variables are
$$
\begin{aligned}
  &amp;amp; S(0) = 7,900,000 \\&lt;br /&gt;
  &amp;amp; I(0) = 10 \\&lt;br /&gt;
  &amp;amp; R(0) = 0 \\&lt;br /&gt;
  &amp;amp; N = S(0) + I(0) + R(0) = 7,900,010
\end{aligned}
$$
and the values for the parameters are $\beta = \frac{1}{2}$, $\gamma = \frac{1}{3}$. All the following numerical methods solve the SIR model with a step size $\Delta t = 1$ day and time steps $t$ ranging from 0 to 200 days.&lt;/p&gt;

&lt;h3 id=&#34;1-2-rk4sir-function&#34;&gt;1.2 &lt;code&gt;RK4SIR&lt;/code&gt; function&lt;/h3&gt;

&lt;p&gt;Firstly, I need three helper functions to describe the dynamic of &lt;strong&gt;S&lt;/strong&gt;, &lt;strong&gt;I&lt;/strong&gt; and &lt;strong&gt;R&lt;/strong&gt; compartments of SIR model. For variants of SIR model, these functions can be easily modified accordingly.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;dSdt &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; beta &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; N&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;

dIdt &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;beta &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; N &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; gamma &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;

dRdt &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;gamma &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Note that the &lt;code&gt;dRdt&lt;/code&gt; function will not be called hereinafter. Here, it&amp;rsquo;s still defined just for the integrity of SIR model and easily understanding.&lt;/p&gt;

&lt;p&gt;Secondly, as per the algorithm of &lt;strong&gt;RK4&lt;/strong&gt;, I create the following &lt;code&gt;RK4SIR&lt;/code&gt; function to solve the SIR model.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;RK4SIR &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R0 &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  N &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;&amp;lt;-&lt;/span&gt; S0 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; I0 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; R0  &lt;span style=&#34;color: #586E75&#34;&gt;# fixed population&lt;/span&gt;
  
  S &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  I &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  R &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;R0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;for&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #268BD2&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    Si &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    Ii &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;#     Ri &amp;lt;- R[i]&lt;/span&gt;
    
    S.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;#     R.k1 &amp;lt;- dRdt(i, Ii)&lt;/span&gt;
    
    S.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;#     R.k2 &amp;lt;- dRdt(i + dt / 2, Ii + dt / 2 * I.k1)&lt;/span&gt;
    
    S.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;#     R.k3 &amp;lt;- dRdt(i + dt / 2, Ii + dt / 2 * I.k2)&lt;/span&gt;
    
    S.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;#     R.k4 &amp;lt;- dRdt(i + dt, Ii + dt * I.k3)&lt;/span&gt;
    
    S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; S.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; I.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;#     R[i + 1] &amp;lt;- Ri + dt / 6 * (R.k1 + 2 * R.k2 + 2 * R.k3 + R.k4)&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
  R &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; N &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;data.frame&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Last, call &lt;code&gt;RK4SIR&lt;/code&gt; to simulate the spread of Hong Kong flu in New York city.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;S0 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;7900000&lt;/span&gt;
I0 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;10&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;# R0 &amp;lt;- 0&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;# N &amp;lt;- S0 + I0 + R0&lt;/span&gt;
beta &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;
gamma &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;3&lt;/span&gt;
n &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;200&lt;/span&gt;

r &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; RK4SIR&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I0&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Use &lt;code&gt;ggplot2&lt;/code&gt; package to plot the resulting $S(t)$, $I(t)$ and $R(t)$ curves.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;library&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;reshape2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
r.plot &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; id &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;n&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; measure &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;S&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;I&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
&lt;span style=&#34;color: #719e07&#34;&gt;library&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;ggplot2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
p &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r.plot&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; aes&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;x &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; y &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; value&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; group &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; color &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
p &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; geom_line&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  ggtitle&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Spread of Hong Kong Flu in New York City&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&#34;http://tonytsai.name/materials/RK4SIR_files/figure-html/unnamed-chunk-4-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;For the spread dynamic of the disease, I am interested in the time $t_{max}$ when the number of infected people gets maximum and the corresponding maximum number of infected people $I_{max}$. $t_{max}$ and $I_{max}$ are also key measures to evaluate the performance of the absolute humidity-driven SIRS model in &lt;a href=&#34;http://www.ploscompbiol.org/article/info%3Adoi%2F10.1371%2Fjournal.pcbi.1003583&#34; target=&#34;_blank&#34;&gt;Yang et al. (2014)&lt;/a&gt;. The following codes give $t_{max}$ and $I_{max}$.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;which.max&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #719e07&#34;&gt;$I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 75
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;max&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #719e07&#34;&gt;$I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 497473.6
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Comparing to the results of the study case &lt;a href=&#34;https://www.math.duke.edu//education/ccp/materials/diffcalc/sir/sir2.html&#34; target=&#34;_blank&#34;&gt;The SIR Model for Spread of Disease&lt;/a&gt;, the trends of $S(t)$, $I(t)$ and $R(t)$ curves are correct. Furthermore, $t_{max} = 75$ is the same to the approximate value of 75 identified from the figure.&lt;/p&gt;

&lt;h3 id=&#34;1-3-rk4sir-yang-function&#34;&gt;1.3 &lt;code&gt;RK4SIR.Yang&lt;/code&gt; function&lt;/h3&gt;

&lt;p&gt;Based on the &lt;code&gt;propagateParSIR&lt;/code&gt; function from the code shipping with &lt;a href=&#34;http://www.ploscompbiol.org/article/info%3Adoi%2F10.1371%2Fjournal.pcbi.1003583&#34; target=&#34;_blank&#34;&gt;Yang et al. (2014)&lt;/a&gt;, I just reproduce the algorithm for easily understanding and create the following function &lt;code&gt;RK4SIR.Yang&lt;/code&gt; to solve the SIR model.&lt;/p&gt;

&lt;p&gt;

&lt;figure class=&#34;code&#34;&gt;
  &lt;figcaption&gt;
  	&lt;span&gt;&lt;/span&gt;
  &lt;/figcaption&gt;
  &lt;div class=&#34;codewrapper&#34;&gt;
    &lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;RK4SIR.Yang &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R0 &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  N &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;&amp;lt;-&lt;/span&gt; S0 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; I0 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; R0  &lt;span style=&#34;color: #586E75&#34;&gt;# fixed population&lt;/span&gt;
  
  S &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  I &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  R &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;R0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;for&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #268BD2&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    Si &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    Ii &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    S.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    
    Ts1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k1
    Ti1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k1
    S.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ts1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ti1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ts1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ti1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    
    Ts2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ts1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2
    Ti2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ti1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2
    S.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ts2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ti2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ts2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ti2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    
    Ts3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ts2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3
    Ti3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ti2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3
    S.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ts3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ti3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ts3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ti3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    
    S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; S.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; I.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    R&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; N &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;data.frame&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
  &lt;/div&gt;
&lt;/figure&gt;

Note that &lt;code&gt;RK4SIR.Yang&lt;/code&gt; is a bit different from &lt;code&gt;RK4SIR&lt;/code&gt; in calculating $k_1$, $k_2$, $k_3$ and $k_4$. The functionality of &lt;code&gt;RK4SIR.Yang&lt;/code&gt; is also tested by the same case.&lt;/p&gt;

&lt;p&gt;Call &lt;code&gt;RK4SIR.Yang&lt;/code&gt; to simulate the spread of Hong Kong flu in New York city.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;r &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; RK4SIR.Yang&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I0&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Plot $S(t)$, $I(t)$ and $R(t)$ curves.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;r.plot &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; id &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;n&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; measure &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;S&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;I&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
p &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r.plot&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; aes&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;x &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; y &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; value&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; group &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; color &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
p &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; geom_line&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  ggtitle&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Spread of Hong Kong Flu in New York City&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&#34;http://tonytsai.name/materials/RK4SIR_files/figure-html/unnamed-chunk-8-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Extract $t_{max}$ and $I_{max}$.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;which.max&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #719e07&#34;&gt;$I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 72
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;max&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #719e07&#34;&gt;$I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 482429.6
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Comparing to the results of &lt;code&gt;RK4SIR&lt;/code&gt;, the results of &lt;code&gt;RK4SIR.Yang&lt;/code&gt; show that the infected indiviuals reaching peak is 3 days earlier and the number of infected individuals is more than 15,000 less. I doubt the &lt;code&gt;RK4SIR.Yang&lt;/code&gt; function gives a wrong solution. To figure out which function (&lt;code&gt;RK4SIR&lt;/code&gt; or &lt;code&gt;RK4SIR.Yang&lt;/code&gt;) implements the &lt;strong&gt;RK4&lt;/strong&gt; method correctly,  I also solve the SIR model by directly calling ODE solvers from the existing software package, including &lt;code&gt;deSolve&lt;/code&gt; package and &lt;code&gt;MATLAB&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&#34;1-4-desolve-package&#34;&gt;1.4 &lt;code&gt;deSolve&lt;/code&gt; package&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;http://cran.r-project.org/web/packages/deSolve/index.html&#34; target=&#34;_blank&#34;&gt;&lt;code&gt;deSolve&lt;/code&gt;&lt;/a&gt; package provides general solvers for inital value problems of ODE, PDE, DAE and DDE. &lt;code&gt;rk4&lt;/code&gt; function from &lt;code&gt;deSolve&lt;/code&gt; package is an implementation of the classical &lt;strong&gt;RK4&lt;/strong&gt; integration algorithm. The steps of invoking &lt;code&gt;rk4&lt;/code&gt; function to solve the SIR model are as follows.&lt;/p&gt;

&lt;p&gt;Firstly, define the initial values and parameters used in the SIR model.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #586E75&#34;&gt;# initial (state) values for SIR model&lt;/span&gt;
y0 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;# vector of time steps&lt;/span&gt;
times &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; n
&lt;span style=&#34;color: #586E75&#34;&gt;# vector of parameters used in SIR model&lt;/span&gt;
params &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;beta &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; gamma &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Secondly, define the SIR model.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;SIR &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; y&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; params&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color: #719e07&#34;&gt;with&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;as.list&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;params&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; y&lt;span style=&#34;color: #93A1A1&#34;&gt;)),&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    dS &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; beta &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; N
    dI &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; beta &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; N &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; gamma &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;
    dR &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; gamma &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;
    &lt;span style=&#34;color: #DC322F&#34;&gt;list&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;dS&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; dI&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; dR&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;})&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Last, call &lt;code&gt;rk4&lt;/code&gt; function to solve the SIR model and plot the results.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;library&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;deSolve&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
r &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt;  rk4&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;y0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; times&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; SIR&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; params&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
plot&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&#34;http://tonytsai.name/materials/RK4SIR_files/figure-html/unnamed-chunk-12-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Similarly, extract $t_{max}$ and $I_{max}$.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;which.max&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #93A1A1&#34;&gt;[,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;I&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 75
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;max&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #93A1A1&#34;&gt;[,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;I&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 497473.6
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The results are the same to those of &lt;code&gt;RK4SIR&lt;/code&gt; function. As &lt;code&gt;deSolve&lt;/code&gt; is a mature package and has been used by numerous users, I believe the $t_{max} = 75$ and  $I_{max} = 4.97474\times 10^{5}$ given by &lt;code&gt;RK4SIR&lt;/code&gt; function are correct.&lt;/p&gt;

&lt;h3 id=&#34;1-5-ode45-function&#34;&gt;1.5 &lt;code&gt;ode45&lt;/code&gt; function&lt;/h3&gt;

&lt;p&gt;Furthermore, I solve the SIR model by calling &lt;code&gt;ode45&lt;/code&gt; function from &lt;code&gt;MATLAB&lt;/code&gt; to further confirm my judgement. The codes are organized in two &lt;code&gt;MATLAB&lt;/code&gt; scripts &lt;code&gt;SIR.m&lt;/code&gt; and &lt;code&gt;simSIR.m&lt;/code&gt;. Since the whole process is very similar to the &lt;code&gt;R&lt;/code&gt; code, I would not explain the codes in detail. Here, I just present the codes.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;SIR.m&lt;/code&gt; defines the ODEs of the SIR model.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt; &lt;/span&gt;dy &lt;span style=&#34;color: #93A1A1&#34;&gt;= &lt;/span&gt;&lt;span style=&#34;color: #268BD2&#34;&gt;SIR&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;t, y, beta, gamma, N&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;% only two ODEs of SIR model are independent&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;% solving three ODE together, MATLAB gives wrong solution&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;S&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;y(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;);&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;I&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;y(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;);&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;dS&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #B58900&#34;&gt;beta&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;S&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;I&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;N;&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;dI&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #B58900&#34;&gt;beta&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;S&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;I&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;N&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #B58900&#34;&gt;gamma&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;I;&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;dy&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;[dS,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;dI]&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;;&lt;/span&gt;
&lt;span style=&#34;color: #719e07&#34;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;simSIR.m&lt;/code&gt; runs the specific simulation of the spread of Hong Kong flu in New York city and gives the results of interest.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;clear&lt;/span&gt;

&lt;span style=&#34;color: #93A1A1&#34;&gt;t&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;200&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;;&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;S0&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;7900000&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;;&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;I0&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;;&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;R0&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;;&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;N&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;S0&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;I0&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;R0;&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;y0&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;[S0,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;I0];&lt;/span&gt;
&lt;span style=&#34;color: #B58900&#34;&gt;beta&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;;&lt;/span&gt;
&lt;span style=&#34;color: #B58900&#34;&gt;gamma&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;;&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;options&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;[];&lt;/span&gt;

&lt;span style=&#34;color: #93A1A1&#34;&gt;[T,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;Y]&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;ode45(@SIR,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;t,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;y0,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;options,&lt;/span&gt; &lt;span style=&#34;color: #B58900&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #B58900&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;N);&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;% plot S, I, R curves&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;S&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;Y(:,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;);&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;I&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;Y(:,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;);&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;R&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;N&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;S&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;I;&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;plot(T,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;S,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;-r&amp;#39;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;T,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;I,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;-g&amp;#39;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;T,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;R,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;-b&amp;#39;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;title(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;Spread of Hong Kong Flu in New York City&amp;#39;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;xlabel(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;Days&amp;#39;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;ylabel(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;Value&amp;#39;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;legend(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;S&amp;#39;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;I&amp;#39;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;R&amp;#39;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;

&lt;span style=&#34;color: #586E75&#34;&gt;% peak of the infected&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;[maxVal,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;ind]&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;max(Y(:,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;% add veritical line to indicate the peak&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;ylim&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;get(gca,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;ylim&amp;#39;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;);&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;%  get y range&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;hold&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;on&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;plot([ind&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;ind&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;],&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;[ylim(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;),&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;ylim(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)],&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;LineStyle&amp;#39;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;--&amp;#39;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The results of running &lt;code&gt;simSIR.m&lt;/code&gt; are&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;simSIR&lt;/span&gt;

&lt;span style=&#34;color: #93A1A1&#34;&gt;ind&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt;

    &lt;span style=&#34;color: #2AA198&#34;&gt;75&lt;/span&gt;
    
&lt;span style=&#34;color: #93A1A1&#34;&gt;maxVal&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;=&lt;/span&gt;

   &lt;span style=&#34;color: #2AA198&#34;&gt;4.9755e+05&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&#34;http://tonytsai.name/materials/RK4SIR_files/figure-html/SIR.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Note that by default &lt;code&gt;MATLAB&lt;/code&gt;&amp;rsquo;s &lt;code&gt;ode45&lt;/code&gt; solver is &lt;a href=&#34;http://en.wikipedia.org/wiki/Dormand%E2%80%93Prince_method&#34; target=&#34;_blank&#34;&gt;DormandPrince method&lt;/a&gt; (alias &lt;code&gt;dopri5&lt;/code&gt;), which is also a member of the RungeKutta family of ODE solvers. As &lt;code&gt;ode45&lt;/code&gt; is adaptive stepsize integration algorithm, it can give more accurate numerical solution than &lt;strong&gt;RK4&lt;/strong&gt; method.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;rk45dp7&lt;/code&gt; (alias &lt;code&gt;ode45&lt;/code&gt;) method from &lt;code&gt;deSolve&lt;/code&gt; package provides &lt;code&gt;ode45&lt;/code&gt; solver for ODEs in &lt;code&gt;R&lt;/code&gt;. Solve the SIR model by using &lt;code&gt;ode45&lt;/code&gt; method in &lt;code&gt;deSolve&lt;/code&gt; and extract $t_{max}$ and $I_{max}$.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;r &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt;  ode&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;y0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; times&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; SIR&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; params&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; method &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; rkMethod&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;ode45&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;# peak of the infected&lt;/span&gt;
&lt;span style=&#34;color: #719e07&#34;&gt;which.max&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #93A1A1&#34;&gt;[,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;I&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 75
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;max&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #93A1A1&#34;&gt;[,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;I&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 497474.2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;$I_{max}$ given by &lt;code&gt;rk4&lt;/code&gt; and &lt;code&gt;ode45&lt;/code&gt; from &lt;code&gt;deSolve&lt;/code&gt; package are almost the same, but both are approximate 80 less than that of &lt;code&gt;ode45&lt;/code&gt; in &lt;code&gt;MATLAB&lt;/code&gt;. The results of &lt;code&gt;ode45&lt;/code&gt; provided by &lt;code&gt;R&lt;/code&gt; and &lt;code&gt;MATLAB&lt;/code&gt; are both right as the discrepancy results from the inherent difference in numerical precision between &lt;code&gt;R&lt;/code&gt; and &lt;code&gt;MATLAB&lt;/code&gt;. For more details refer to &lt;a href=&#34;http://blog.tonytsai.name/2014/11/Precision-Difference-of-ode45-between-R-and-MATLAB/&#34; target=&#34;_blank&#34;&gt;Appendix A&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The results given by both &lt;code&gt;deSolve&lt;/code&gt; package and &lt;code&gt;MATLAB&lt;/code&gt; show that $I_{max} = 75$ is the right answer. I am pretty sure that the results from &lt;code&gt;RK4SIR&lt;/code&gt; function are correct; however, the &lt;code&gt;RK4SIR.Yang&lt;/code&gt; function  ${\color{red}{doesn&amp;rsquo;t\ correctly}}$ implement &lt;strong&gt;RK4&lt;/strong&gt; method for solving SIR model. Since the &lt;code&gt;RK4SIR.Yang&lt;/code&gt; function gives a bit ealier $I_{max}$, I wonder whether this wrong &lt;strong&gt;RK4&lt;/strong&gt; method has any influence on the conclusions of &lt;a href=&#34;http://www.ploscompbiol.org/article/info%3Adoi%2F10.1371%2Fjournal.pcbi.1003583&#34; target=&#34;_blank&#34;&gt;Yang et al. (2014)&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;2-incidence&#34;&gt;2 Incidence&lt;/h2&gt;

&lt;h3 id=&#34;2-1-preliminary&#34;&gt;2.1 Preliminary&lt;/h3&gt;

&lt;p&gt;Instead of $S(t)$, $I(t)$ and $R(t)$ of SIR model, health workers in practice often collect daily number of newly infected people. This is the loosely expressed &lt;a href=&#34;http://en.wikipedia.org/wiki/Incidence_%28epidemiology%29&#34; target=&#34;_blank&#34;&gt;incidence&lt;/a&gt;. Besides incidence, cummulative incidence is also of interest. Let $C(t)$ denote incidence at time $t$, $P(t)$ denote cummulative incidence at time $t$. $C(t)$ and $P(t)$ can be calculated as follows
$$
\begin{aligned}
  &amp;amp; C(t) = \frac{dP}{dt} = \frac{\beta SI}{N} \\&lt;br /&gt;
  &amp;amp; C(t_0) = S_0 \\&lt;br /&gt;
  &amp;amp; P(t) = \int_0^t{C(t)}dt = \int_0^t{\frac{\beta SI}{N}}dt
\end{aligned}
$$&lt;/p&gt;

&lt;p&gt;In some references, &lt;a href=&#34;http://en.wikipedia.org/wiki/Incidence_%28epidemiology%29&#34; target=&#34;_blank&#34;&gt;cummulative incidence&lt;/a&gt; (also known as &lt;strong&gt;incidence proportion&lt;/strong&gt;) refers to the number of new cases $P(T)$ within a specified time period $T$ divided by the size of the population initially at risk $N$, expressed as $P(T)$ cases per $N$ persons, or $\frac{P(T)}{N}\times 100\%$. The rigorous definition of incidence is &lt;a href=&#34;http://en.wikipedia.org/wiki/Incidence_%28epidemiology%29#Incidence_rate&#34; target=&#34;_blank&#34;&gt;incidence rate&lt;/a&gt;, which is expressed as $P(T)$ cases per $N$ persons per $T$ time, or $\frac{P(T)}{N\times T}\times 100\%$.&lt;/p&gt;

&lt;h3 id=&#34;2-2-rk4sir-function&#34;&gt;2.2 &lt;code&gt;RK4SIR&lt;/code&gt; function&lt;/h3&gt;

&lt;p&gt;A logical parameter &lt;code&gt;incidence&lt;/code&gt; is added to &lt;code&gt;RK4SIR&lt;/code&gt; function to control whether or not incidence and cummulative incidence are returned.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;RK4SIR &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R0 &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; incidence &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;FALSE&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  N &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;&amp;lt;-&lt;/span&gt; S0 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; I0 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; R0
  
  S &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  I &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  R &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;R0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;for&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #268BD2&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    Si &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    Ii &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    
    S.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    
    S.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    
    S.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    
    S.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    
    S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; S.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; I.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
  R &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; N &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;
  
  &lt;span style=&#34;color: #268BD2&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;!&lt;/span&gt;incidence&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;data.frame&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color: #586E75&#34;&gt;# newly infected per day (incidence)&lt;/span&gt;
    inc &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;diff&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
    &lt;span style=&#34;color: #586E75&#34;&gt;# cumulative incidence&lt;/span&gt;
    cum.inc &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;cumsum&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;inc&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;data.frame&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; inc &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; inc&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; cum.inc &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; cum.inc&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Use the updated &lt;code&gt;RK4SIR&lt;/code&gt; function to track the time-varying incidence and cummulative incidence of the same study case.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;r &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; RK4SIR&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; incidence &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;TRUE&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;# # plot S, I, R, incidence, cummulative incidence curves&lt;/span&gt;
r.plot &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; id &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;n&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; measure &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;S&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;I&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;inc&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;cum.inc&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
p &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r.plot&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; aes&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;x &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; y &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; value&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; group &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; color &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
p &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; geom_line&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  scale_colour_discrete&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;name &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Legend&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; 
                      breaks &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;S&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;I&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;inc&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;cum.inc&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;),&lt;/span&gt; 
                      labels &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Susceptible&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Infected &amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Recovered&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Incidence&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; 
                               &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Cummulative incidence&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  ggtitle&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Spread of Hong Kong Flu in New York City&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&#34;http://tonytsai.name/materials/RK4SIR_files/figure-html/unnamed-chunk-16-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;As shown in the above figure, the time when incidence reaches peak is a bit earlier than that of the infected people. The following codes give the exact results.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;which.max&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;inc&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 73
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;max&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;r&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;inc&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## [1] 173488.5
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;2-3-rk4sir-yang-function&#34;&gt;2.3 &lt;code&gt;RK4SIR.Yang&lt;/code&gt; function&lt;/h3&gt;

&lt;p&gt;I also update &lt;code&gt;RK4SIR.Yang&lt;/code&gt; function to return cummulative incidence based on the algorithm from &lt;code&gt;propagateParSIR&lt;/code&gt; function. The initial cummulative incidence $C_0$ is 0, which is $S_0$ in &lt;code&gt;RK4SIR&lt;/code&gt; function; however, I think it&amp;rsquo;s more consistent to set $C_0 = S_0$. Notably, the &lt;code&gt;RK4&lt;/code&gt; method for &lt;code&gt;RK4SIR.Yang&lt;/code&gt; hasn&amp;rsquo;t been corrected and the function doesn&amp;rsquo;t return incidence.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;RK4SIR.Yang &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R0 &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; incidence &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;FALSE&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
  N &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;&amp;lt;-&lt;/span&gt; S0 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; I0 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; R0
  
  S &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  I &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  R &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;R0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  cum.inc &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;rep&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; n &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;  &lt;span style=&#34;color: #586E75&#34;&gt;# cumulative incidence&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;for&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #268BD2&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    Si &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    Ii &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    S.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Si&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ii&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    CI.k1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; S.k1
    
    Ts1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k1
    Ti1 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k1
    S.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ts1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ti1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ts1&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ti1&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    CI.k2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; S.k2
    
    Ts2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ts1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2
    Ti2 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ti1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2
    S.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ts2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ti2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ts2&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ti2&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    CI.k3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; S.k3
    
    Ts3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ts2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3
    Ti3 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ti2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3
    S.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dSdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ts3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ti3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    I.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; dIdt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ts3&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; Ti3&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    CI.k4 &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; S.k4
    
    S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Si &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; S.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; S.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Ii &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;I.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; I.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; I.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
    R&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; N &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt;
    cum.inc&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; cum.inc&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color: #93A1A1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; dt &lt;span style=&#34;color: #719e07&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;CI.k1 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; CI.k2 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; CI.k3 &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; CI.k4&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
  &lt;span style=&#34;color: #268BD2&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;!&lt;/span&gt;incidence&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;data.frame&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color: #268BD2&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #DC322F&#34;&gt;data.frame&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; S&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; R &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; R&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; cum.inc &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; cum.inc&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
  &lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;span style=&#34;color: #93A1A1&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&#34;2-4-benchmark&#34;&gt;2.4 Benchmark&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;microbenchmark&lt;/code&gt; package is a good option for benchmarking functions. I use &lt;code&gt;microbenchmark&lt;/code&gt; function to compare &lt;code&gt;rk4&lt;/code&gt;, &lt;code&gt;RK4SIR&lt;/code&gt; and &lt;code&gt;RK4SIR.Yang&lt;/code&gt; 1000 times.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;library&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;microbenchmark&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
compare &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; microbenchmark&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;rk4&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;y0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; times&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; SIR&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; params&lt;span style=&#34;color: #93A1A1&#34;&gt;),&lt;/span&gt; 
                          RK4SIR&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; incidence &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;TRUE&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;),&lt;/span&gt; 
                          RK4SIR.Yang&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;n&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;beta&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gamma&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; I0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; incidence &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;TRUE&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;),&lt;/span&gt; 
                          times &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #586E75&#34;&gt;# change expr for plot&lt;/span&gt;
compare&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;expr &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gsub&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;rk4(y0, times, SIR, params)&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;rk4&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; 
                     compare&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;expr&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; fixed &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;TRUE&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
compare&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;expr &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gsub&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;RK4SIR(n, beta, gamma, S0, I0, incidence = TRUE)&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;RK4SIR&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; 
                     compare&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;expr&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; fixed &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;TRUE&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
compare&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;expr &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;gsub&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;RK4SIR.Yang(n, beta, gamma, S0, I0, incidence = TRUE)&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; 
                     &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;RK4SIR.Yang&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; compare&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;expr&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; fixed &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #CB4B16&#34;&gt;TRUE&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
compare
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;## Unit: milliseconds
##         expr       min        lq      mean    median        uq       max
##          rk4 26.633415 26.808269 31.203988 27.158211 29.086869 63.952667
##       RK4SIR  3.767904  4.084908  4.628463  4.308558  5.080188  6.447710
##  RK4SIR.Yang  4.590251  4.771556  5.317731  4.902217  4.985512  8.661047
##  neval
##     10
##     10
##     10
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Draw a comparison of distribution times.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;p &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; autoplot&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;compare&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
p &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; geom_violin&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;aes&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;color &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; expr&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; fill &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; expr&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  theme&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;legend.position &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;none&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&#34;http://tonytsai.name/materials/RK4SIR_files/figure-html/unnamed-chunk-20-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;rk4&lt;/code&gt; function from &lt;code&gt;deSolve&lt;/code&gt; package runs much slower than both &lt;code&gt;RK4SIR&lt;/code&gt; and &lt;code&gt;RK4SIR.Yang&lt;/code&gt; fucntions as it takes much time to spin up for calling external &lt;code&gt;FORTRAN&lt;/code&gt; or &lt;code&gt;C&lt;/code&gt; functions. Though &lt;code&gt;RK4SIR&lt;/code&gt; function performs the extra calculation of incidence, the benchmarking results show that &lt;code&gt;RK4SIR&lt;/code&gt; function still runs faster than &lt;code&gt;RK4SIR.Yang&lt;/code&gt; function. This is because &lt;code&gt;RK4SIR.Yang&lt;/code&gt; function calculates cummulative incidence one by one per iterative formula while &lt;code&gt;RK4SIR&lt;/code&gt; function directly apply &lt;code&gt;diff&lt;/code&gt; function to the resulting vector &lt;code&gt;S&lt;/code&gt; to accomplish the calculation. &lt;code&gt;diff&lt;/code&gt; function is a vector operation and takes much less time.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Problems with adduser on Ubuntu and Solutions</title>
      <link>http://blog.tonytsai.name/blog/2014-09-30-problems-with-adduser-on-ubuntu-and-solutions/</link>
      <pubDate>Tue, 30 Sep 2014 23:44:46 -0400</pubDate>
      
      <guid>http://blog.tonytsai.name/blog/2014-09-30-problems-with-adduser-on-ubuntu-and-solutions/</guid>
      <description>

&lt;p&gt;Ubuntu&lt;code&gt;ssh&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&#34;1-&#34;&gt;1. &lt;/h4&gt;

&lt;p&gt;Linux&lt;em&gt;root&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;root&lt;/em&gt;&lt;em&gt;zyw&lt;/em&gt; &lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ su - root
$ useradd zyw
$ passwd zyw
&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id=&#34;2-&#34;&gt;2. &lt;/h4&gt;

&lt;p&gt;&lt;em&gt;zyw&lt;/em&gt;&lt;code&gt;ssh&lt;/code&gt;Ubuntu&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Could not chdir to home directory /home/zyw: No such file or directory
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;useradd&lt;/code&gt;&lt;code&gt;-d&lt;/code&gt;&lt;em&gt;zyw&lt;/em&gt;&lt;strong&gt;/home/zyw&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ mkdir /home/zyw
$ chown zyw:zyw /home/zyw
$ chmod &lt;span style=&#34;color: #2AA198&#34;&gt;0700&lt;/span&gt; /home/zyw
&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id=&#34;3--user-host-path&#34;&gt;3. &lt;code&gt;[user@host path]$&lt;/code&gt;&lt;/h4&gt;

&lt;p&gt;Ubuntu&lt;code&gt;$&lt;/code&gt;&lt;code&gt;[user@host path]$&lt;/code&gt;&lt;code&gt;ls&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;google&lt;code&gt;shell&lt;/code&gt;&lt;code&gt;bash&lt;/code&gt;&lt;code&gt;shell&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span style=&#34;color: #B58900&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;$SHELL&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;sh&lt;/code&gt;&lt;code&gt;bash&lt;/code&gt;&lt;strong&gt;/etc/passwd&lt;/strong&gt;&lt;em&gt;zyw&lt;/em&gt;&lt;code&gt;shell&lt;/code&gt;&lt;code&gt;bash&lt;/code&gt;&lt;strong&gt;/etc/passwd&lt;/strong&gt;&lt;code&gt;sudo&lt;/code&gt;&lt;code&gt;sudo&lt;/code&gt;&lt;code&gt;sudoers&lt;/code&gt;&lt;em&gt;root&lt;/em&gt;&lt;code&gt;visudo&lt;/code&gt;&lt;strong&gt;/etc/sudoers&lt;/strong&gt;&lt;code&gt;root    ALL=(ALL)       ALL&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;zyw    ALL=(ALL)       ALL
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;em&gt;zyw&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;zyw&lt;/em&gt;&lt;strong&gt;/etc/passwd&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;zyw:x:1001:1001::/home/zyw:/bin/sh
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;em&gt;zyw&lt;/em&gt;&lt;code&gt;shell&lt;/code&gt;&lt;strong&gt;/bin/bash&lt;/strong&gt;&lt;/p&gt;

&lt;h4 id=&#34;4-&#34;&gt;4. &lt;/h4&gt;

&lt;p&gt;Terminal&lt;code&gt;ls -a&lt;/code&gt;&lt;strong&gt;.bashrc&lt;/strong&gt;&lt;strong&gt;.profile&lt;/strong&gt;&lt;strong&gt;/etc/skel&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ cp /etc/skel/.bashrc /home/zyw/
$ cp /etc/skel/.profile /home/zyw/
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Terminal&lt;/p&gt;

&lt;h3 id=&#34;&#34;&gt;&lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://www.cyberciti.biz/faq/linux-unix-appleosx-bsd-could-not-chdir-to-home-directory/&#34; target=&#34;_blank&#34;&gt;Could not chdir to home directory: No such file or directory Error and Solution&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://my.oschina.net/shangjx13/blog/32155&#34; target=&#34;_blank&#34;&gt;ubuntuadduser&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://my.oschina.net/shangjx13/blog/30626&#34; target=&#34;_blank&#34;&gt;linux &lt;/a&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://superuser.com/questions/68397/why-does-my-linux-prompt-show-a-instead-of-the-login-name-and-path&#34; target=&#34;_blank&#34;&gt;Why does my Linux prompt show a $, instead of the login name and path?&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>Commonly Used ArcGIS Tools by Myself</title>
      <link>http://blog.tonytsai.name/blog/2014-09-21-commonly-used-arcgis-tools-by-myself/</link>
      <pubDate>Sun, 21 Sep 2014 23:44:46 -0400</pubDate>
      
      <guid>http://blog.tonytsai.name/blog/2014-09-21-commonly-used-arcgis-tools-by-myself/</guid>
      <description>

&lt;p&gt;ArcGIS toolboxgoogle&lt;/p&gt;

&lt;h4 id=&#34;1-&#34;&gt;1. &lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;Analysis Tools -&amp;gt; Extract -&amp;gt; Clip
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;2-&#34;&gt;2. &lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;Spatial Analyst -&amp;gt; Extraction -&amp;gt; Extract by Mask
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;3-&#34;&gt;3. &lt;/h4&gt;

&lt;p&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Data Management Tools -&amp;gt; Features -&amp;gt; Polygon To Line
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;LEFT_FID != -1&lt;/code&gt;feature&lt;/p&gt;

&lt;h4 id=&#34;4-&#34;&gt;4. &lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;Data Management Tools -&amp;gt; Projections and Transformations -&amp;gt; Define Projection
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;5-merge-multiple-polygons-into-multipart-feature&#34;&gt;5. Merge multiple polygons into multipart feature&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;Data Mangement Tools -&amp;gt; Generalization -&amp;gt; Dissolve
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;6-overlay-analysis-count-attribute-statistics-for-points-in-polygon&#34;&gt;6. Overlay analysis (count, attribute statistics) for points in polygon&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;Analysis Tools -&amp;gt; Overlay -&amp;gt; Spatial Join
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;7-find-the-nearest-point-for-each-point-feature&#34;&gt;7. Find the nearest point for each point feature&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;Analysis Tools -&amp;gt; Proximity -&amp;gt; Generate Near Table
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br&gt;
clipprojectionArcGIS&lt;code&gt;Search&lt;/code&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Host Is Down Using curl/wget While Page Loads in Browser</title>
      <link>http://blog.tonytsai.name/blog/2014-08-23-host-is-down-using-curl/wget-while-page-loads-in-browser/</link>
      <pubDate>Sat, 23 Aug 2014 23:44:46 -0400</pubDate>
      
      <guid>http://blog.tonytsai.name/blog/2014-08-23-host-is-down-using-curl/wget-while-page-loads-in-browser/</guid>
      <description>

&lt;h3 id=&#34;&#34;&gt;&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/caijun/geoChina&#34; target=&#34;_blank&#34;&gt;&lt;em&gt;geoChina&lt;/em&gt;&lt;/a&gt;Mac&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;library&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;geoChina&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
geocode&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;Tsinghua University&amp;#39;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; api &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;google&amp;#39;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; ocs &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;GCJ-02&amp;#39;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; messaging &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;T&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;


&lt;figure class=&#34;code&#34;&gt;
  &lt;figcaption&gt;
  	&lt;span&gt;&lt;/span&gt;
  &lt;/figcaption&gt;
  &lt;div class=&#34;codewrapper&#34;&gt;
    &lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;1
2
3
4
5
6&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;calling http://maps.googleapis.com/maps/api/geocode/json?address&lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt;Tsinghua%20University&lt;span style=&#34;color: #93A1A1&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color: #268BD2&#34;&gt;sensor&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color: #B58900&#34;&gt;false&lt;/span&gt; ...
Warning message:
In readLines&lt;span style=&#34;color: #719e07&#34;&gt;(&lt;/span&gt;connect, &lt;span style=&#34;color: #268BD2&#34;&gt;warn&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; FALSE&lt;span style=&#34;color: #719e07&#34;&gt;)&lt;/span&gt; :
  unable to connect to &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;maps.googleapis.com&amp;#39;&lt;/span&gt; on port 80.
Error in fromJSON&lt;span style=&#34;color: #719e07&#34;&gt;(&lt;/span&gt;paste&lt;span style=&#34;color: #719e07&#34;&gt;(&lt;/span&gt;readLines&lt;span style=&#34;color: #719e07&#34;&gt;(&lt;/span&gt;connect, &lt;span style=&#34;color: #268BD2&#34;&gt;warn&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; FALSE&lt;span style=&#34;color: #719e07&#34;&gt;)&lt;/span&gt;, &lt;span style=&#34;color: #268BD2&#34;&gt;collapse&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;))&lt;/span&gt; : 
  error in evaluating the argument &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;content&amp;#39;&lt;/span&gt; in selecting a method &lt;span style=&#34;color: #719e07&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;fromJSON&amp;#39;&lt;/span&gt;: Error in readLines&lt;span style=&#34;color: #719e07&#34;&gt;(&lt;/span&gt;connect, &lt;span style=&#34;color: #268BD2&#34;&gt;warn&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; FALSE&lt;span style=&#34;color: #719e07&#34;&gt;)&lt;/span&gt; : cannot open the connection
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
  &lt;/div&gt;
&lt;/figure&gt;
&lt;/p&gt;

&lt;p&gt;&lt;code&gt;geocode&lt;/code&gt;jsonWindows&lt;/p&gt;

&lt;h3 id=&#34;&#34;&gt;&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;geoChina&lt;/em&gt;MacMachttp80https44380&lt;/p&gt;

&lt;p&gt;&lt;code&gt;curl&lt;/code&gt;&lt;code&gt;wget&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ wget www.google.com
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Resolving www.google.com... 2404:6800:4005:805::1012, 173.194.127.244, 173.194.127.242, ...
Connecting to www.google.com|2404:6800:4005:805::1012|:80... failed: Host is down.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ curl -v -L www.google.com
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* Rebuilt URL to: www.google.com/
* Hostname was NOT found in DNS cache
*   Trying 2404:6800:4005:801::1010...
*   Trying 173.194.127.241...
* connect to 2404:6800:4005:801::1010 port 80 failed: Host is down
* connect to 173.194.127.241 port 80 failed: Host is down
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;Host is down&lt;/code&gt;&lt;code&gt;www.baidu.com&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;80googleMacgoogle&lt;a href=&#34;#[1]&#34;&gt;[1]&lt;/a&gt;&lt;em&gt;GoAgent&lt;/em&gt;80google&lt;/p&gt;

&lt;h3 id=&#34;&#34;&gt;&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;#[1]&#34;&gt;[1]&lt;/a&gt;http/httpsgoogle Mac OS X&lt;a href=&#34;#[2]&#34;&gt;[2]&lt;/a&gt;&lt;em&gt;GoAgent&lt;/em&gt;&lt;code&gt;~/.bash_profile&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #B58900&#34;&gt;export&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;http_proxy&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;http://localhost:8103&amp;#39;&lt;/span&gt;
&lt;span style=&#34;color: #B58900&#34;&gt;export&lt;/span&gt; &lt;span style=&#34;color: #268BD2&#34;&gt;https_proxy&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;http://localhost:8103&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;.bash_profile&lt;/code&gt;&lt;code&gt;.bash_profile&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span style=&#34;color: #B58900&#34;&gt;source&lt;/span&gt; .bash_profile
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;curl&lt;/code&gt;&lt;code&gt;wget&lt;/code&gt;googleMac&lt;code&gt;geoChina::geocode&lt;/code&gt;&lt;code&gt;geoChina&lt;/code&gt;Windows&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;&lt;br&gt;
PS:&lt;a href=&#34;http://celavie.me/lib/2013/10/19/Markdown%E5%86%99%E4%BD%9C%EF%BC%88%E4%BA%8C%EF%BC%89.html&#34; target=&#34;_blank&#34;&gt;/&lt;/a&gt;&lt;em&gt;Markdown&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&#34;&#34;&gt;&lt;/h3&gt;

&lt;p&gt;&lt;span id=&#34;[1]&#34;&gt;[1]&lt;/span&gt;: &lt;a href=&#34;http://superuser.com/questions/518297/unable-to-resolve-host-using-curl-wget-while-page-loads-in-browser&#34; target=&#34;_blank&#34;&gt;Unable to resolve host using curl/wget while page loads in browser&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;span id=&#34;[2]&#34;&gt;[2]&lt;/span&gt;: &lt;a href=&#34;http://codelife.me/blog/2012/09/02/how-to-set-proxy-for-terminal/&#34; target=&#34;_blank&#34;&gt;MacOS X&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;&#34;&gt;&lt;/h3&gt;

&lt;p&gt;GFWGoogleGoogle Maps APIditu.google.cnmaps.google.comGeoIPGoogle Maps API&lt;a href=&#34;https://github.com/caijun/geoChina&#34; target=&#34;_blank&#34;&gt;&lt;em&gt;geoChina&lt;/em&gt;&lt;/a&gt;&lt;code&gt;1.1.3&lt;/code&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Introduction to git and GitHub</title>
      <link>http://blog.tonytsai.name/blog/2014-07-13-introduction-to-git-and-github/</link>
      <pubDate>Sun, 13 Jul 2014 23:44:46 -0400</pubDate>
      
      <guid>http://blog.tonytsai.name/blog/2014-07-13-introduction-to-git-and-github/</guid>
      <description>

&lt;h3 id=&#34;git&#34;&gt;git&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;http://brew.sh/&#34; target=&#34;_blank&#34;&gt;Homebrew&lt;/a&gt;Mac OS X&lt;em&gt;Homebrew&lt;/em&gt;(Hugomarkdown parser&lt;a href=&#34;https://github.com/russross/blackfriday&#34; target=&#34;_blank&#34;&gt;blackfriday&lt;/a&gt;*italic*)Ruby Mac OS X &lt;em&gt;Homebrew&lt;/em&gt; &lt;a href=&#34;https://github.com/mxcl/homebrew&#34; target=&#34;_blank&#34;&gt;Github&lt;/a&gt;&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;To install &lt;em&gt;Homebrew&lt;/em&gt;, run following command in terminal. Note that &lt;code&gt;ruby&lt;/code&gt; is installed by default on Mac OS X.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ ruby -e &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;$(&lt;/span&gt;curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install&lt;span style=&#34;color: #719e07&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;It is quite easy to install &lt;em&gt;git&lt;/em&gt; through &lt;em&gt;Homebrew&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ brew install git
&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;git-&#34;&gt;git &lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;github&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ git clone git@github.com:caijun/blog.tonytsai.name.git
&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ git status
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;git&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ git add .
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;.&lt;/code&gt;&lt;br /&gt;
&lt;code&gt;git 2.0&lt;/code&gt;&lt;code&gt;warning&lt;/code&gt;&lt;code&gt;git add --all&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ git commit -m &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;#39;commit message&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;githubgithub&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ git remote add origin git@github.com:caijun/blog.tonytsai.name.git
&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ git remote -v
&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;$ git push -u origin master
&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;git&#34;&gt;git&lt;/h3&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;&#34;&gt;&lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://www.cnblogs.com/fnng/archive/2011/08/25/2153807.html&#34; target=&#34;_blank&#34;&gt;git/github&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://www.cnblogs.com/fnng/archive/2012/01/07/2315685.html&#34; target=&#34;_blank&#34;&gt;git/github&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>A Chinese Beamer for Ecophilosophy Class Presentation</title>
      <link>http://blog.tonytsai.name/blog/2013-12-04-a-chinese-beamer-for-ecophilosophy-class-presentation/</link>
      <pubDate>Wed, 04 Dec 2013 23:44:46 -0400</pubDate>
      
      <guid>http://blog.tonytsai.name/blog/2013-12-04-a-chinese-beamer-for-ecophilosophy-class-presentation/</guid>
      <description>&lt;p&gt;Beamer&lt;a href=&#34;http://blog.tonytsai.name/2013/06/A-beamer-for-doctoral-english-class-final-presentation/&#34; target=&#34;_blank&#34;&gt;slides&lt;/a&gt;slides&lt;a href=&#34;http://tonytsai.name/materials/TonyTsai+20131127.pdf&#34; target=&#34;_blank&#34;&gt;slides&lt;/a&gt;HyperlinksButtons&lt;a href=&#34;http://jabref.sourceforge.net/&#34; target=&#34;_blank&#34;&gt;JabRef&lt;/a&gt;$\LaTeX$&lt;a href=&#34;http://en.wikipedia.org/wiki/BibTeX&#34; target=&#34;_blank&#34;&gt;BibTeX&lt;/a&gt;&lt;br /&gt;
xeCJKXeLaTeX + BibTeX + XeLaTeXXeLaTeXBibTeX&lt;br /&gt;
&lt;a href=&#34;http://tonytsai.name/materials/TonyTsai+20131127.tex&#34; target=&#34;_blank&#34;&gt;&lt;/a&gt;$\TeX$&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>