<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Matlab on Tony Tsai</title>
    <link>http://blog.tonytsai.name/tags/matlab/index.xml</link>
    <description>Recent content in Matlab on Tony Tsai</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <atom:link href="http://blog.tonytsai.name/tags/matlab/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Precision Difference of ode45 between R and MATLAB</title>
      <link>http://blog.tonytsai.name/blog/2014-11-24-precision-difference-of-ode45-between-r-and-matlab/</link>
      <pubDate>Mon, 24 Nov 2014 23:44:46 -0400</pubDate>
      
      <guid>http://blog.tonytsai.name/blog/2014-11-24-precision-difference-of-ode45-between-r-and-matlab/</guid>
      <description>&lt;p&gt;&lt;code&gt;ode45&lt;/code&gt; solvers from both &lt;code&gt;R&lt;/code&gt; and &lt;code&gt;MATLAB&lt;/code&gt; are used to run simulations of the &lt;a href=&#34;https://www.math.duke.edu//education/ccp/materials/diffcalc/sir/sir1.html&#34; target=&#34;_blank&#34;&gt;spread of Hong Kong flu in New York city&lt;/a&gt; with different initial susceptible individuals $S_0 =$ 790, 7900, 79000, 790000, and 7900000. The maximum infected people $I_{max}$ under each condition is recorded for comparison. The following codes draw a figure showing the precision difference of &lt;code&gt;ode45&lt;/code&gt; solvers between &lt;code&gt;R&lt;/code&gt; and &lt;code&gt;MATLAB&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #002B36&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;Imax &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;data.frame&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S0 &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;79&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;10&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;^&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;),&lt;/span&gt; 
                   R &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;57.12598&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;504.9923&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;4984.303&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;49749.60&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;497474.2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;),&lt;/span&gt; 
                   MATLAB &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;57.14987&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;505.3385&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;4987.447&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;49774.26&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;497552.2&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
Imax&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color: #586E75&#34;&gt;`MATLAB - R`&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; Imax&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;MATLAB &lt;span style=&#34;color: #719e07&#34;&gt;-&lt;/span&gt; Imax&lt;span style=&#34;color: #719e07&#34;&gt;$&lt;/span&gt;R
&lt;span style=&#34;color: #586E75&#34;&gt;# plot delta Imax VS. S0&lt;/span&gt;
Imax.plot &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; melt&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;Imax&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; id &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;S0&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; measure &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #DC322F&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;R&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;MATLAB&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;MATLAB - R&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
&lt;span style=&#34;color: #719e07&#34;&gt;library&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;scales&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
p &lt;span style=&#34;color: #719e07&#34;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;Imax.plot&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; aes&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;x &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; S0&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; y &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; value&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; group &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; color &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;))&lt;/span&gt;
p &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; geom_line&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  geom_point&lt;span style=&#34;color: #93A1A1&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  scale_x_log10&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;name &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;expression&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;S&lt;span style=&#34;color: #93A1A1&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;]),&lt;/span&gt; breaks &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;79&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;10&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;^&lt;/span&gt; &lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;),&lt;/span&gt; labels &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; comma&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  scale_y_continuous&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;name &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Imax&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; labels &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; comma&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  facet_wrap&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #719e07&#34;&gt;~&lt;/span&gt; variable&lt;span style=&#34;color: #93A1A1&#34;&gt;,&lt;/span&gt; scales &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;free&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  ggtitle&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #2AA198&#34;&gt;&amp;quot;Precision Diffference of ode45 Solver between R and MATLAB&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #719e07&#34;&gt;+&lt;/span&gt; 
  theme_bw&lt;span style=&#34;color: #93A1A1&#34;&gt;(&lt;/span&gt;base_size &lt;span style=&#34;color: #719e07&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color: #2AA198&#34;&gt;14&lt;/span&gt;&lt;span style=&#34;color: #93A1A1&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&#34;http://tonytsai.name/materials/RK4SIR_files/figure-html/unnamed-chunk-21-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;As shown in the right panel, the difference of $I_{max}$ increases with the initial susceptible number $S_0$ getting larger. When $S_0 &amp;lt; 8,000$, the difference is no more than 1. When $S_0$ is very large, the absolute precision difference also becomes larger; however, the relative accuracy keeps and it is accepted in this case.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>